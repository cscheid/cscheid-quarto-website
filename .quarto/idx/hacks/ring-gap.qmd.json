{"title":"Ring with rotating gap","markdown":{"yaml":{"title":"Ring with rotating gap","date":"2018-09-27","categories":["optical-illusion"]},"headingText":"Acknowledgements","containsRefs":false,"markdown":"\n\nThis is a continuous version of the [purple dots\nillusion](./purple-dots.qmd). Keep staring at the\ncrosshairs. Eventually, instead of a white gap rotating, you'll start\nseeing a bright band of the opponent color.\n\nIncidentally, you'll notice that this opponent color is quite bright -\nit in fact appears brighter than the white background of your display!\nThis is because you're experiencing a [Chimerical\ncolor](https://en.wikipedia.org/wiki/Impossible_color).\n\n<div id=\"main\" style=\"height: 600px\"></div>\n\n```{ojs}\nimport { dom, time } from \"/src/cscheid/cscheid.js\";\n\n{\n    var canvasEl = d3.select(\"#main\").append(\"canvas\")\n        .attr(\"width\", 600)\n        .attr(\"height\", 600);\n\n    var canvasCrosshair = d3.select(\"#main\").append(\"canvas\")\n        .attr(\"width\", 600)\n        .attr(\"height\", 600)\n        .style(\"position\", \"relative\")\n        .style(\"top\", \"-600px\");\n\n    d3.select(\"#main\").select(\"div\").style(\"height\", \"600px\");\n\n    var ctx = dom.setupCanvas(canvasEl.node());\n    var xhCtx = dom.setupCanvas(canvasCrosshair.node());\n\n    // crosshairs\n    xhCtx.fillStyle = \"rgba(0,0,0,0)\";\n    xhCtx.fillRect(0,0,600,600);\n    xhCtx.strokeStyle = \"black\";\n    xhCtx.lineWidth = 1 * ctx.dpr;\n    xhCtx.beginPath();\n    xhCtx.moveTo(280, 300);\n    xhCtx.lineTo(320, 300);\n    xhCtx.moveTo(300, 280);\n    xhCtx.lineTo(300, 320);\n    xhCtx.stroke();\n\n    canvasEl.node().style.filter = \"blur(10px)\";\n\n    function tick()\n    {\n    var now = time.elapsed();\n\n    // wipe\n    ctx.fillStyle = \"white\";\n    ctx.fillRect(0,0,600,600);\n\n    ctx.lineWidth = 30 * ctx.dpr;\n\n    var nSteps = ~~(100 * Math.PI * 2);\n    var radius = 200;\n    var xScale = d3.scaleLinear().domain([-1, 1]).range([50, 550]);\n    var yScale = d3.scaleLinear().domain([-1, 1]).range([550, 50]);\n\n    for (var i=0; i<nSteps; ++i) {\n        var angleBeg = (i / nSteps) * Math.PI * 2;\n        var angleEnd = ((i+1.5) / nSteps) * Math.PI * 2;\n        var lerp = d3.interpolateLab(d3.hcl(angleBeg * 180 / Math.PI, 70, 50), \"white\");\n\n        var gapCenterAngle = now * (Math.PI * 2) % (Math.PI * 2);\n        var sigma2 = 1;\n        var weight = Math.max(\n        Math.exp(-Math.pow(gapCenterAngle - angleBeg, 2) / sigma2),\n        Math.exp(-Math.pow((gapCenterAngle + 2 * Math.PI) - angleBeg, 2) / sigma2),\n        Math.exp(-Math.pow((gapCenterAngle - 2 * Math.PI) - angleBeg, 2) / sigma2),\n        );\n\n        ctx.strokeStyle = String(lerp(weight));\n        ctx.beginPath();\n        ctx.moveTo(xScale(Math.cos(angleBeg)), yScale(Math.sin(angleBeg)));\n        ctx.lineTo(xScale(Math.cos(angleEnd)), yScale(Math.sin(angleEnd)));\n        ctx.stroke();\n    }\n\n    window.requestAnimationFrame(tick);\n    }\n\n    tick();\n}\n```\n\n\nI'm sure this has been discovered before, but I came up with this\nparticular version.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"ring-gap.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"99.9.9","theme":["sandstone","../cscheid-net.scss"],"title":"Ring with rotating gap","date":"2018-09-27","categories":["optical-illusion"]},"extensions":{"book":{"multiFile":true}}}}}