{"title":"Checkerboard and Crosses","markdown":{"yaml":{"title":"Checkerboard and Crosses","date":"2017-12-05","categories":["optical-illusion"]},"headingText":"Acknowledgments","containsRefs":false,"markdown":"\n\nThe checkerboard stays straight throughout the animation.\n\n<div id=\"main\"></div>\n\n```{ojs}\n{\n    var svg = d3.select(\"#main\").append(\"svg\").attr(\"width\", 600).attr(\"height\", 800).append(\"g\");\n\n    svg.attr(\"transform\", \"translate(0,0)\");\n    function cycleScroll() {\n        svg.transition().duration(1000)\n            .attr(\"transform\", \"translate(0, 200)\")\n            .transition().duration(1000)\n            .attr(\"transform\", \"translate(0,0)\")\n            .on(\"end\", cycleScroll);\n    }\n    cycleScroll();       \n\n    function roundUp(x) {\n        return ~~(x + 0.5);\n    };\n\n    var squaresData = [];\n    var xScale = d3.scaleLinear().domain([0,12]).range([0, 600]);\n    var yScale = d3.scaleLinear().domain([0,12]).range([600, 0]);\n    for (var i=0; i<12; ++i) {\n        for (var j=1; j<12; ++j) {\n            squaresData.push({\n                x: i, y: j,\n                color: (i ^ j) & 1\n            });\n        }\n    }\n    var crossesData = [];\n    for (i=1; i<12; ++i) {\n        for (j=1; j<11; ++j) {\n            var c = i + j;\n            var vs = [0, 1, 0, 1, 1, 0, 1, 0];\n            var vs2 = [0, 0, 1, 1];\n            crossesData.push({\n                x: i, y: j,\n                color_1: vs[c % 8],\n                color_2: (i ^ j) & 1,\n                color_3: Math.random() > 0.5 ? 1 : 0,\n                color_4: vs2[c % 4]\n            });\n        }\n    }\n\n    svg.append(\"g\")\n        .selectAll(\"rect\")\n        .data(squaresData)\n        .enter()\n        .append(\"rect\")\n        .attr(\"x\", d => ~~xScale(d.x))\n        .attr(\"y\", d => ~~yScale(d.y))\n        .attr(\"width\", roundUp(xScale(1) - xScale(0)))\n        .attr(\"height\", roundUp(xScale(1) - xScale(0)))\n        .attr(\"fill\", d => d.color ? d3.hcl(0, 0, 40) : d3.hcl(0, 0, 60));\n\n    var crossesG = svg.append(\"g\");\n    var crosses = crossesG\n            .selectAll(\"path\")\n            .data(crossesData)\n            .enter()\n            .append(\"path\");\n\n    var lightCross = d3.hcl(0, 0, 100);\n    var darkCross =  d3.hcl(0, 0, 0);\n\n    crosses\n        .attr(\"transform\", d => (\"translate(\" + xScale(d.x) + \",\" + yScale(d.y) + \")\"))\n        .attr(\"d\", \"M -2,-2  l 0,-6  l 2,-2  l 2,2  l 0,6  l 6,0  l 2,2  l -2,2  l -6,0  l 0,6  l -2,2 l -2,-2  l 0,-6  l -6,0  l -2,-2 l 2,-2\")\n        .attr(\"fill\", d => !d.color_1 ? darkCross : lightCross);\n\n    function changeToAndThen(f, next) {\n        crossesG.selectAll(\"path\")\n            .transition()\n            .delay(1000)\n            .duration(2000)\n            .attr(\"opacity\", 0)\n            .transition()\n            .duration(10)\n            .attr(\"fill\", f)\n            .transition()\n            .duration(2000)\n            .attr(\"opacity\", 1)\n            .on(\"end\", (d, i) => i === 0 ? next() : null);\n    }\n\n    function cyclePatterns() {\n        var accessors = [\"color_1\", \"color_2\", \"color_3\", \"color_4\"];\n        var fs = accessors.map((accessor, i) =>\n                            (() => changeToAndThen(d => d[accessor] ? darkCross : lightCross,\n                                                    fs[(i+1)%accessors.length])));\n        fs[0]();\n    }\n\n    cyclePatterns();\n}\n```\n\n\n([Source](http://bigblueboo.tumblr.com/post/81390584151/fooled-ya-brain)). Thanks, [Pete](https://twitter.com/Peter_shirley)!.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"checkerboard-and-crosses.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"99.9.9","theme":["sandstone","../cscheid-net.scss"],"title":"Checkerboard and Crosses","date":"2017-12-05","categories":["optical-illusion"]},"extensions":{"book":{"multiFile":true}}}}}