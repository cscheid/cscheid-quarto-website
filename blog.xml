<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Carlos Scheidegger</title>
<link>https://cscheid.net/v2/blog.html</link>
<atom:link href="https://cscheid.net/v2/blog.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.2.269</generator>
<lastBuildDate>Sun, 20 Nov 2022 00:00:00 GMT</lastBuildDate>
<item>
  <title>Same site, new look</title>
  <link>https://cscheid.net/v2/blog/2022-11-20.html</link>
  <description><![CDATA[ 



<p>It’s been a while! The birdsite ate blogging, and then the muskrat ate the birdsite. As insurance policy, I’m on <a href="https://mastodon.social/@scheidegger">mastodon</a>.</p>
<p>I also changed jobs. (I managed a good 6 months without writing the requisite academic quit-lit piece, but I make no future promises!) I’m now an engineer at <a href="https://posit.co">Posit</a>. We used to be called RStudio, you might remember that name instead! We still build RStudio, and still build world-class open-source R libraries. But we’ve been making tools for other ecosystems for a long while, and the R-centric name got in the way a little bit.</p>
<p>I work full-time on <a href="https://quarto.org">quarto</a>, which I’m really excited about. I think we might actually make a dent on technical and academic communication. More about it soon.</p>
<p>I’m not planning on turning comments back on. If you want to say hi, send me an email (start with the email address you see on the main page, but use Posit’s domain instead) or a note on Mastodon. Maybe we’ll do manual trackback links here like it’s 2001 or something!</p>


<!-- -->


 ]]></description>
  <guid>https://cscheid.net/v2/blog/2022-11-20.html</guid>
  <pubDate>Sun, 20 Nov 2022 00:00:00 GMT</pubDate>
</item>
<item>
  <title>A JS Cadence Sensor</title>
  <link>https://cscheid.net/v2/hacks/cadence-sensor.html</link>
  <description><![CDATA[ 



<p>At some point during the pandemic, I became suspicious about the accuracy of my <a href="https://saris.com/products/h3-direct-drive-smart-trainer">Saris H3</a> cadence sensor, so I wrote my own. (It turns out that the cadence sensor is fine.)</p>
<script src="../src/lib/d3.v5.js"></script>
<script src="../src/lib/dsp.js"></script>
<button id="start">
Start Cadence Sensor
</button>
<div>
RPM: <span id="rpm-reader"></span>
</div>
<div id="error-message">

</div>
<div id="chart1">

</div>
<div id="chart2">

</div>
<script src="cadence-sensor/main.js"></script>
<section id="how-it-works" class="level2">
<h2 class="anchored" data-anchor-id="how-it-works">How it works</h2>
<p>The algorithm is embarrassingly simple for how well it works:</p>
<ul>
<li>Capture the time series of the accelerometer data (with a 1s half-life exponential decay),</li>
<li>compute the PCA, and extract the first principal component. You now have a 1D time series</li>
<li>Compute the FFT, and find the period with largest energy.</li>
</ul>
<p>Smartphones: supercomputer processing power, tricorder sensors. Amazing stuff.</p>


<!-- -->

</section>

 ]]></description>
  <category>signal-processing</category>
  <guid>https://cscheid.net/v2/hacks/cadence-sensor.html</guid>
  <pubDate>Thu, 02 Jun 2022 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Bunimovich Stadium</title>
  <link>https://cscheid.net/v2/hacks/bunimovich-stadium.html</link>
  <description><![CDATA[ 



<script src="../src/lib/d3.v5.js"></script>
<p>The Bunimovich Stadium is one example of a <a href="https://en.wikipedia.org/wiki/Dynamical_billiards">Dynamical Billiards</a> table that exhibits chaotic behavior even with only concave scatterings. Trajectories in the Bunimovich stadium exhibit (eventual) exponential divergence over time.</p>
<p>In addition, <a href="https://en.wikipedia.org/wiki/Almost_surely">almost any</a> trajectory in a Bunimovich stadium eventually gets arbitrarily close to any point of the stadium. This is in sharp contrast to trajectories in elliptical billiards: any one trajectory in elliptical billiards will always leave a chunk of the table unexplored.</p>
<div id="main">

</div>
<div id="reset-bunimovich">

</div>
<div id="reset-elliptical">

</div>
<div id="clear-tracks">

</div>
<script type="module" src="bunimovich-stadium/main.js"></script>
<section id="acknowledgments" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgments">Acknowledgments</h2>
<p>Inspiration for this post came from <a href="http://blogs.ams.org/visualinsight/2016/11/15/bunimovich-stadium/">Baez’s post on the stadium</a>.</p>


<!-- -->

</section>

 ]]></description>
  <category>mathematics</category>
  <guid>https://cscheid.net/v2/hacks/bunimovich-stadium.html</guid>
  <pubDate>Sat, 14 Nov 2020 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/images/bunimovich-stadium.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>An Interactive Fagan Nomogram</title>
  <link>https://cscheid.net/v2/hacks/fagan-nomogram.html</link>
  <description><![CDATA[ 



<!-- <script src="/src/lib/d3.v5.js"></script>
 -->
<p>The Fagan nomogram <span class="citation" data-cites="letter1975nomogram">(Fagan 1975)</span> is a nomogram <span class="citation" data-cites="enwiki:1085193589">(Wikipedia contributors 2022)</span> that computes the probability of the presence of some condition based on an imperfect test and varying pre-test probabilities. It is a very handy tool to understand Bayes’s Theorem “physically”. People typically have a sense that the less powerful the test, the less likely it is that a positive test result means the presence of the condition. But people are much less likely to grasp the role of the pre-test probability <span class="citation" data-cites="casscells1978interpretation">(Casscells, Schoenberger, and Graboys 1978)</span>.</p>
<p>As an illustration, consider the example illustrated in the default setting of the nomogram below. If only 10% of the population exhibit a particular kind of condition, then even if a test gives a ratio of true positives to false positives at 10 to 1, only 50% of the people tested positive will actually exhibit the condition.</p>
<p>Similarly, if only 10% of the population exhibits the condition, then in order to be 90% sure that a positive result indicates the presence of the condition, the test can give a false-positive result only 1 every 100 times it gives true positive results. Intuitively, what’s going on is that the base-10 logarithm of the “likelihood ratio” (10 and 100 respectively in the examples above) is the “number of nines added to the baseline probability”, interpreting a probability of 0.1 as having “negative 1 nine”.</p>
<p>The original nomogram was meant to be used with a physical ruler to do the calculations. Here, you can grab the circles and move them around to change the settings.</p>
<div id="main">

</div>
<!-- <script type="module" src="fagan-nomogram/main.js"></script> -->
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="46" data-source-offset="-0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 45;"><span id="cb1-46"><span class="im" style="color: #00769E;">import</span> { svg } <span class="im" style="color: #00769E;">from</span> <span class="st" style="color: #20794D;">"/src/cscheid/cscheid.js"</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-47"></span>
<span id="cb1-48">{</span>
<span id="cb1-49">  svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">setupD3Prototype</span>(d3)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-50"></span>
<span id="cb1-51">  <span class="kw" style="color: #003B4F;">let</span> svgNode <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"#main"</span>)</span>
<span id="cb1-52">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"svg"</span>)</span>
<span id="cb1-53">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"viewBox"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"0 0 920 400"</span>)</span>
<span id="cb1-54">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"100%"</span>)</span>
<span id="cb1-55">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"100%"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-56"></span>
<span id="cb1-57">  <span class="kw" style="color: #003B4F;">const</span> scaleBounds <span class="op" style="color: #5E5E5E;">=</span> [<span class="dv" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">700</span>]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-58"></span>
<span id="cb1-59">  <span class="kw" style="color: #003B4F;">let</span> preTestScaleLogOdds <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()</span>
<span id="cb1-60">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span>])</span>
<span id="cb1-61">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(scaleBounds)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-62"></span>
<span id="cb1-63">  <span class="kw" style="color: #003B4F;">let</span> postTestScaleLogOdds <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()</span>
<span id="cb1-64">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">3</span>])</span>
<span id="cb1-65">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(scaleBounds)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-66"></span>
<span id="cb1-67">  <span class="kw" style="color: #003B4F;">let</span> logLikelihoodRatioScale <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()</span>
<span id="cb1-68">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">6</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">6</span>])</span>
<span id="cb1-69">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(scaleBounds)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-70"></span>
<span id="cb1-71">  <span class="kw" style="color: #003B4F;">let</span> labels <span class="op" style="color: #5E5E5E;">=</span> [<span class="st" style="color: #20794D;">'pre-test probability'</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-72">                <span class="st" style="color: #20794D;">'likelihood ratio'</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-73">                <span class="st" style="color: #20794D;">'post-test probability'</span>]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-74"></span>
<span id="cb1-75">  <span class="kw" style="color: #003B4F;">let</span> yScale <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span><span class="dv" style="color: #AD0000;">2</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">100</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-76"></span>
<span id="cb1-77">  svgNode<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-78">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"text"</span>)</span>
<span id="cb1-79">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(labels)</span>
<span id="cb1-80">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-81">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"text"</span>)</span>
<span id="cb1-82">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">910</span>)</span>
<span id="cb1-83">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>(d<span class="op" style="color: #5E5E5E;">,</span> i) { <span class="cf" style="color: #003B4F;">return</span> <span class="fu" style="color: #4758AB;">yScale</span>(i)<span class="op" style="color: #5E5E5E;">;</span> })</span>
<span id="cb1-84">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"dy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">3</span>)</span>
<span id="cb1-85">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">text</span>(<span class="kw" style="color: #003B4F;">function</span>(d) { <span class="cf" style="color: #003B4F;">return</span> d<span class="op" style="color: #5E5E5E;">;</span> })</span>
<span id="cb1-86">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"label"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-87"></span>
<span id="cb1-88">  <span class="kw" style="color: #003B4F;">let</span> preTestLineG <span class="op" style="color: #5E5E5E;">=</span> svgNode<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-89">  <span class="kw" style="color: #003B4F;">let</span> preTestLine <span class="op" style="color: #5E5E5E;">=</span> preTestLineG</span>
<span id="cb1-90">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-91">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">preTestScaleLogOdds</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span>))</span>
<span id="cb1-92">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">preTestScaleLogOdds</span>(<span class="dv" style="color: #AD0000;">3</span>))</span>
<span id="cb1-93">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">100</span>)</span>
<span id="cb1-94">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">100</span>)</span>
<span id="cb1-95">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"test-line"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-96"></span>
<span id="cb1-97">  <span class="kw" style="color: #003B4F;">let</span> lrLineG <span class="op" style="color: #5E5E5E;">=</span> svgNode<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-98">  <span class="kw" style="color: #003B4F;">let</span> lrLine <span class="op" style="color: #5E5E5E;">=</span> lrLineG</span>
<span id="cb1-99">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-100">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">logLikelihoodRatioScale</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">4</span>))</span>
<span id="cb1-101">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">logLikelihoodRatioScale</span>(<span class="dv" style="color: #AD0000;">4</span>))</span>
<span id="cb1-102">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">200</span>)</span>
<span id="cb1-103">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">200</span>)</span>
<span id="cb1-104">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"test-line"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-105"></span>
<span id="cb1-106">  <span class="kw" style="color: #003B4F;">let</span> postTestLineG <span class="op" style="color: #5E5E5E;">=</span> svgNode<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-107">  <span class="kw" style="color: #003B4F;">let</span> postTestLine <span class="op" style="color: #5E5E5E;">=</span> postTestLineG</span>
<span id="cb1-108">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-109">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">postTestScaleLogOdds</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span>))</span>
<span id="cb1-110">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">postTestScaleLogOdds</span>(<span class="dv" style="color: #AD0000;">3</span>))</span>
<span id="cb1-111">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)</span>
<span id="cb1-112">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)</span>
<span id="cb1-113">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"test-line"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-114"></span>
<span id="cb1-115">  <span class="co" style="color: #5E5E5E;">//////////////////////////////////////////////////////////////////////////////</span></span>
<span id="cb1-116">  <span class="co" style="color: #5E5E5E;">// this could be solved automatically..</span></span>
<span id="cb1-117"></span>
<span id="cb1-118">  <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">expFmt</span>(v) {</span>
<span id="cb1-119">      <span class="kw" style="color: #003B4F;">let</span> l <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">pow</span>(<span class="dv" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">,</span> v)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-120">      <span class="kw" style="color: #003B4F;">let</span> r <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">fmt</span>(l <span class="op" style="color: #5E5E5E;">/</span> (<span class="dv" style="color: #AD0000;">1</span> <span class="op" style="color: #5E5E5E;">+</span> l))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-121">      <span class="cf" style="color: #003B4F;">return</span> r</span>
<span id="cb1-122">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">replace</span>(<span class="ss" style="color: #20794D;">/0</span><span class="sc" style="color: #5E5E5E;">+$</span><span class="ss" style="color: #20794D;">/</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">""</span>)</span>
<span id="cb1-123">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">replace</span>(<span class="ss" style="color: #20794D;">/</span><span class="sc" style="color: #5E5E5E;">(\.</span><span class="ss" style="color: #20794D;">.</span><span class="sc" style="color: #5E5E5E;">*)</span><span class="ss" style="color: #20794D;">09</span><span class="sc" style="color: #5E5E5E;">+$</span><span class="ss" style="color: #20794D;">/</span><span class="op" style="color: #5E5E5E;">,</span> (match<span class="op" style="color: #5E5E5E;">,</span> p1) <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="vs" style="color: #20794D;">`</span><span class="sc" style="color: #5E5E5E;">${</span>p1<span class="sc" style="color: #5E5E5E;">}</span><span class="vs" style="color: #20794D;">1`</span>)<span class="op" style="color: #5E5E5E;">;</span> <span class="co" style="color: #5E5E5E;">// i'm so sorry, universe.</span></span>
<span id="cb1-124">  }</span>
<span id="cb1-125"></span>
<span id="cb1-126">  <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">lrFmt</span>(v) {</span>
<span id="cb1-127">      <span class="kw" style="color: #003B4F;">let</span> l <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">pow</span>(<span class="dv" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">,</span> v)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-128">      <span class="cf" style="color: #003B4F;">if</span> (l <span class="op" style="color: #5E5E5E;">==</span> <span class="op" style="color: #5E5E5E;">~~</span>l)</span>
<span id="cb1-129">          <span class="cf" style="color: #003B4F;">return</span> <span class="bu" style="color: null;">String</span>(l)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-130">      <span class="cf" style="color: #003B4F;">else</span> </span>
<span id="cb1-131">          <span class="cf" style="color: #003B4F;">return</span> <span class="bu" style="color: null;">String</span>(l)</span>
<span id="cb1-132">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">replace</span>(<span class="ss" style="color: #20794D;">/0</span><span class="sc" style="color: #5E5E5E;">+$</span><span class="ss" style="color: #20794D;">/</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">""</span>)</span>
<span id="cb1-133">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">replace</span>(<span class="ss" style="color: #20794D;">/</span><span class="sc" style="color: #5E5E5E;">(\.</span><span class="ss" style="color: #20794D;">.</span><span class="sc" style="color: #5E5E5E;">*)</span><span class="ss" style="color: #20794D;">09</span><span class="sc" style="color: #5E5E5E;">+$</span><span class="ss" style="color: #20794D;">/</span><span class="op" style="color: #5E5E5E;">,</span> (match<span class="op" style="color: #5E5E5E;">,</span> p1) <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="vs" style="color: #20794D;">`</span><span class="sc" style="color: #5E5E5E;">${</span>p1<span class="sc" style="color: #5E5E5E;">}</span><span class="vs" style="color: #20794D;">1`</span>)<span class="op" style="color: #5E5E5E;">;</span> <span class="co" style="color: #5E5E5E;">// i'm so sorry, universe.</span></span>
<span id="cb1-134">  }</span>
<span id="cb1-135"></span>
<span id="cb1-136">  <span class="kw" style="color: #003B4F;">let</span> preProbTicks <span class="op" style="color: #5E5E5E;">=</span> {</span>
<span id="cb1-137">      <span class="dt" style="color: #AD0000;">list</span><span class="op" style="color: #5E5E5E;">:</span> [<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">0.954245</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fl" style="color: #AD0000;">0.954245</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">3</span>]<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-138">      <span class="dt" style="color: #AD0000;">scale</span><span class="op" style="color: #5E5E5E;">:</span> preTestScaleLogOdds<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-139">      <span class="dt" style="color: #AD0000;">fmt</span><span class="op" style="color: #5E5E5E;">:</span> expFmt</span>
<span id="cb1-140">  }<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-141"></span>
<span id="cb1-142">  <span class="kw" style="color: #003B4F;">let</span> postProbTicks <span class="op" style="color: #5E5E5E;">=</span> {</span>
<span id="cb1-143">      <span class="dt" style="color: #AD0000;">list</span><span class="op" style="color: #5E5E5E;">:</span> [<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">0.954245</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fl" style="color: #AD0000;">0.954245</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">3</span>]<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-144">      <span class="dt" style="color: #AD0000;">scale</span><span class="op" style="color: #5E5E5E;">:</span> postTestScaleLogOdds<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-145">      <span class="dt" style="color: #AD0000;">fmt</span><span class="op" style="color: #5E5E5E;">:</span> expFmt</span>
<span id="cb1-146">  }<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-147"></span>
<span id="cb1-148">  <span class="kw" style="color: #003B4F;">let</span> lrTicks   <span class="op" style="color: #5E5E5E;">=</span> {</span>
<span id="cb1-149">      <span class="dt" style="color: #AD0000;">list</span><span class="op" style="color: #5E5E5E;">:</span> [<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">4</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">4</span>]<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-150">      <span class="dt" style="color: #AD0000;">scale</span><span class="op" style="color: #5E5E5E;">:</span> logLikelihoodRatioScale<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-151">      <span class="dt" style="color: #AD0000;">fmt</span><span class="op" style="color: #5E5E5E;">:</span> lrFmt</span>
<span id="cb1-152">  }<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-153"></span>
<span id="cb1-154">  <span class="kw" style="color: #003B4F;">let</span> fmt <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">format</span>(<span class="st" style="color: #20794D;">".3f"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-155"></span>
<span id="cb1-156">  <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">addTicks</span>(ticks)</span>
<span id="cb1-157">  {</span>
<span id="cb1-158">      <span class="cf" style="color: #003B4F;">return</span> <span class="kw" style="color: #003B4F;">function</span>(sel) {</span>
<span id="cb1-159">          <span class="kw" style="color: #003B4F;">let</span> gs <span class="op" style="color: #5E5E5E;">=</span> sel</span>
<span id="cb1-160">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enterMany</span>(ticks<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">list</span>)</span>
<span id="cb1-161">                  <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-162">          gs<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-163">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>(d) { <span class="cf" style="color: #003B4F;">return</span> ticks<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scale</span>(d)<span class="op" style="color: #5E5E5E;">;</span> })</span>
<span id="cb1-164">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>(d) { <span class="cf" style="color: #003B4F;">return</span> ticks<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scale</span>(d)<span class="op" style="color: #5E5E5E;">;</span> })</span>
<span id="cb1-165">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">5</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">5</span>)</span>
<span id="cb1-166">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"test-line"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-167">          gs<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"text"</span>)</span>
<span id="cb1-168">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>(d) { <span class="cf" style="color: #003B4F;">return</span> ticks<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scale</span>(d)<span class="op" style="color: #5E5E5E;">;</span> })</span>
<span id="cb1-169">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">15</span>)</span>
<span id="cb1-170">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"tick-label"</span>)</span>
<span id="cb1-171">              <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">text</span>(<span class="kw" style="color: #003B4F;">function</span>(d) { <span class="cf" style="color: #003B4F;">return</span> ticks<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">fmt</span>(d)<span class="op" style="color: #5E5E5E;">;</span> })<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-172">      }<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-173">  }</span>
<span id="cb1-174"></span>
<span id="cb1-175">  preTestLineG</span>
<span id="cb1-176">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-177">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">translate</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">100</span>))</span>
<span id="cb1-178">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">callReturn</span>(<span class="fu" style="color: #4758AB;">addTicks</span>(preProbTicks))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-179"></span>
<span id="cb1-180">  lrLineG</span>
<span id="cb1-181">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-182">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">translate</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">200</span>))</span>
<span id="cb1-183">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">callReturn</span>(<span class="fu" style="color: #4758AB;">addTicks</span>(lrTicks))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-184"></span>
<span id="cb1-185">  postTestLineG</span>
<span id="cb1-186">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-187">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">translate</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>))</span>
<span id="cb1-188">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">callReturn</span>(<span class="fu" style="color: #4758AB;">addTicks</span>(postProbTicks))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-189"></span>
<span id="cb1-190">  <span class="kw" style="color: #003B4F;">let</span> nomogramLine <span class="op" style="color: #5E5E5E;">=</span> svgNode<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-191">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">preTestScaleLogOdds</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>))</span>
<span id="cb1-192">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">100</span>)</span>
<span id="cb1-193">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">postTestScaleLogOdds</span>(<span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-194">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)</span>
<span id="cb1-195">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"class"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"test-line"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-196"></span>
<span id="cb1-197">  <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">updateLine</span>() {</span>
<span id="cb1-198">      nomogramLine<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span> preTestHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-199">      nomogramLine<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span> postTestHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-200">  }</span>
<span id="cb1-201"></span>
<span id="cb1-202">  <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">dragAttrs</span>(sel) {</span>
<span id="cb1-203">      <span class="cf" style="color: #003B4F;">return</span> sel<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">5</span>)</span>
<span id="cb1-204">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"white"</span>)</span>
<span id="cb1-205">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb1-206">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cursor"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"pointer"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-207">  }</span>
<span id="cb1-208"></span>
<span id="cb1-209">  <span class="kw" style="color: #003B4F;">let</span> preTestHandle <span class="op" style="color: #5E5E5E;">=</span> svgNode<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-210">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">preTestScaleLogOdds</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>))</span>
<span id="cb1-211">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">100</span>)</span>
<span id="cb1-212">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">callReturn</span>(dragAttrs)</span>
<span id="cb1-213">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">call</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">drag</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"drag"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>(<span class="bu" style="color: null;">event</span>) {</span>
<span id="cb1-214">              <span class="cf" style="color: #003B4F;">debugger</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-215">              d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="kw" style="color: #003B4F;">this</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="bu" style="color: null;">event</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-216">              <span class="kw" style="color: #003B4F;">let</span> lrX <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Number</span>(lrHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-217">              <span class="kw" style="color: #003B4F;">let</span> dx <span class="op" style="color: #5E5E5E;">=</span> lrX <span class="op" style="color: #5E5E5E;">-</span> <span class="bu" style="color: null;">event</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-218">              postTestHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> lrX <span class="op" style="color: #5E5E5E;">+</span> dx)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-219">              <span class="fu" style="color: #4758AB;">updateLine</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-220">          }))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-221"></span>
<span id="cb1-222">  <span class="kw" style="color: #003B4F;">let</span> lrHandle <span class="op" style="color: #5E5E5E;">=</span> svgNode<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-223">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fl" style="color: #AD0000;">0.5</span> <span class="op" style="color: #5E5E5E;">*</span> (<span class="fu" style="color: #4758AB;">postTestScaleLogOdds</span>(<span class="dv" style="color: #AD0000;">0</span>) <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;">preTestScaleLogOdds</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>)))</span>
<span id="cb1-224">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">200</span>)</span>
<span id="cb1-225">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">callReturn</span>(dragAttrs)</span>
<span id="cb1-226">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">call</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">drag</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"drag"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>(<span class="bu" style="color: null;">event</span>) {</span>
<span id="cb1-227">              <span class="cf" style="color: #003B4F;">debugger</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-228">              d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="kw" style="color: #003B4F;">this</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="bu" style="color: null;">event</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-229">              <span class="kw" style="color: #003B4F;">let</span> ptX <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Number</span>(preTestHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-230">              <span class="kw" style="color: #003B4F;">let</span> dx <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">event</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span> <span class="op" style="color: #5E5E5E;">-</span> ptX<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-231">              postTestHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="bu" style="color: null;">event</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span> <span class="op" style="color: #5E5E5E;">+</span> dx)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-232">              <span class="fu" style="color: #4758AB;">updateLine</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-233">          }))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-234"></span>
<span id="cb1-235">  <span class="kw" style="color: #003B4F;">let</span> postTestHandle <span class="op" style="color: #5E5E5E;">=</span> svgNode<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-236">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">postTestScaleLogOdds</span>(<span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-237">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)</span>
<span id="cb1-238">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">callReturn</span>(dragAttrs)</span>
<span id="cb1-239">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">call</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">drag</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"drag"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>(<span class="bu" style="color: null;">event</span>) {</span>
<span id="cb1-240">              <span class="cf" style="color: #003B4F;">debugger</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-241">              d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="kw" style="color: #003B4F;">this</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="bu" style="color: null;">event</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-242">              lrHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fl" style="color: #AD0000;">0.5</span> <span class="op" style="color: #5E5E5E;">*</span> (<span class="bu" style="color: null;">event</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="bu" style="color: null;">Number</span>(preTestHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span>))))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-243">              <span class="fu" style="color: #4758AB;">updateLine</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-244">          }))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-245">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="expression">

</div>
</div>
</div>
</div>


<!-- -->



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-casscells1978interpretation" class="csl-entry">
Casscells, Ward, Arno Schoenberger, and Thomas B Graboys. 1978. <span>“Interpretation by Physicians of Clinical Laboratory Results.”</span> <em>New England Journal of Medicine</em> 299 (18): 999–1001.
</div>
<div id="ref-letter1975nomogram" class="csl-entry">
Fagan, T. J. 1975. <span>“Nomogram for Bayes Theorem.”</span> <em>N Engl J Med</em> 293 (5): 257.
</div>
<div id="ref-enwiki:1085193589" class="csl-entry">
Wikipedia contributors. 2022. <span>“Nomogram — <span>Wikipedia</span><span>,</span> the Free Encyclopedia.”</span> <a href="https://en.wikipedia.org/w/index.php?title=Nomogram&amp;oldid=1085193589">https://en.wikipedia.org/w/index.php?title=Nomogram&amp;oldid=1085193589</a>.
</div>
</div></section></div> ]]></description>
  <category>mathematics</category>
  <category>data-science</category>
  <guid>https://cscheid.net/v2/hacks/fagan-nomogram.html</guid>
  <pubDate>Sat, 14 Nov 2020 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/images/fagan-nomogram.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Straight movement on circle</title>
  <link>https://cscheid.net/v2/hacks/straight-movement-on-circle.html</link>
  <description><![CDATA[ 



<p>Each individual circle moves along a straight line, but collectively, they look like a circle rolling inside a larger circle:</p>
<div id="main">

</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="14" data-source-offset="-0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 13;"><span id="cb1-14"><span class="im" style="color: #00769E;">import</span> { dom<span class="op" style="color: #5E5E5E;">,</span> time<span class="op" style="color: #5E5E5E;">,</span> math<span class="op" style="color: #5E5E5E;">,</span> svg <span class="im" style="color: #00769E;">as</span> _svg } <span class="im" style="color: #00769E;">from</span> <span class="st" style="color: #20794D;">"/src/cscheid/cscheid.js"</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-15"></span>
<span id="cb1-16">{</span>
<span id="cb1-17">    <span class="kw" style="color: #003B4F;">let</span> svg <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"#main"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"svg"</span>)</span>
<span id="cb1-18">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"viewBox"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"0 0 600 600"</span>)</span>
<span id="cb1-19">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"100%"</span>)</span>
<span id="cb1-20">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"100%"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-21"></span>
<span id="cb1-22">    <span class="kw" style="color: #003B4F;">var</span> scale <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">25</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">575</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-23"></span>
<span id="cb1-24">    svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-25">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-26">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-27">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">1</span>) <span class="op" style="color: #5E5E5E;">-</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-28">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb1-29">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"none"</span>)</span>
<span id="cb1-30">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"3px"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-31"></span>
<span id="cb1-32">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">makeMovingCircles</span>(angles)</span>
<span id="cb1-33">    {</span>
<span id="cb1-34">        <span class="cf" style="color: #003B4F;">return</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-35">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-36">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(angles)</span>
<span id="cb1-37">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-38">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-39">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">abs</span>(<span class="fu" style="color: #4758AB;">scale</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">0.95</span>) <span class="op" style="color: #5E5E5E;">-</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>)))</span>
<span id="cb1-40">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(math<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">radians</span>(d<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span>)) <span class="op" style="color: #5E5E5E;">*</span> <span class="fl" style="color: #AD0000;">0.95</span>))</span>
<span id="cb1-41">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-42">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(d<span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">70</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">70</span>))</span>
<span id="cb1-43">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> _svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">rotate</span>(d<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>)<span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>)))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-44">    }</span>
<span id="cb1-45"></span>
<span id="cb1-46">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">makeSupportingLines</span>(angles)</span>
<span id="cb1-47">    {</span>
<span id="cb1-48">        <span class="cf" style="color: #003B4F;">return</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-49">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-50">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(angles)</span>
<span id="cb1-51">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-52">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-53">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>))</span>
<span id="cb1-54">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>( <span class="dv" style="color: #AD0000;">1</span>))</span>
<span id="cb1-55">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-56">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-57">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"gray"</span>)</span>
<span id="cb1-58">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"none"</span>)</span>
<span id="cb1-59">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"1px"</span>)</span>
<span id="cb1-60">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> _svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">rotate</span>(d<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>)<span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">scale</span>(<span class="dv" style="color: #AD0000;">0</span>)))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-61">    }</span>
<span id="cb1-62"></span>
<span id="cb1-63">    <span class="kw" style="color: #003B4F;">var</span> angles <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="dv" style="color: #AD0000;">16</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">map</span>(d <span class="kw" style="color: #003B4F;">=&gt;</span> d <span class="op" style="color: #5E5E5E;">*</span> (<span class="dv" style="color: #AD0000;">360</span> <span class="op" style="color: #5E5E5E;">/</span> <span class="dv" style="color: #AD0000;">16</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-64">    <span class="fu" style="color: #4758AB;">makeSupportingLines</span>(angles)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-65">    <span class="kw" style="color: #003B4F;">var</span> sel <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">makeMovingCircles</span>(angles)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-66"></span>
<span id="cb1-67">    dom<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">animate</span>(<span class="kw" style="color: #003B4F;">function</span>() {</span>
<span id="cb1-68">        <span class="kw" style="color: #003B4F;">let</span> t <span class="op" style="color: #5E5E5E;">=</span> time<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">elapsed</span>() <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">90</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-69">        sel<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">scale</span>(</span>
<span id="cb1-70">            <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(math<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">radians</span>(d<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span> <span class="op" style="color: #5E5E5E;">+</span> t)) <span class="op" style="color: #5E5E5E;">*</span> <span class="fl" style="color: #AD0000;">0.95</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-71">    })<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-72">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<section id="acknowledgments" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgments">Acknowledgments</h2>
<p>As usual, found <a href="https://twitter.com/ZonePhysics/status/1190328863571808257">on twitter</a>. Apparently this is known as a <a href="https://en.wikipedia.org/wiki/Tusi_couple">Tusi couple</a>.</p>


<!-- -->

</section>

 ]]></description>
  <category>optical-illusion</category>
  <guid>https://cscheid.net/v2/hacks/straight-movement-on-circle.html</guid>
  <pubDate>Sat, 14 Nov 2020 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/images/straight-movement-on-circle.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Error-Correcting Output Codes</title>
  <link>https://cscheid.net/v2/explainers/ecoc.html</link>
  <description><![CDATA[ 



<p>Often it will be the case that we can model a process we care about as two parties communicating with one another over a <em>noisy channel</em>. Sometimes this is very straightforward: if you’re sending the content of a website to a cellphone, the radio in the cellphone will need to be able to figure out when the message was garbled, and will need to figure out how to fix it. Surprisingly, some techniques in data science also benefit from this change in perspective.</p>
<p>Consider the problem of creating a classifier that can distinguish between more than two classes. We could try to solve this problem from first principles and build that classifier “from nothing”. But if we already know how to build binary classifiers, then we could try to turn the problem of multiple classification into (many instances of) binary classification. The usual way of doing this are called “OVA”, and “AVA”], but there’s a different method that sometimes works better, is elegant, simple to explain, and connects directly to the idea of two parties communicating over a noisy channel.</p>
<section id="prelude-binary-tree-reductions" class="level2">
<h2 class="anchored" data-anchor-id="prelude-binary-tree-reductions">Prelude: Binary-tree reductions</h2>
<p>Let’s first introduce a slightly different, but very simple reduction. Let’s work, for now, with the case of an 8-class problem, so the actual class to be predicted is one of <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code>, <code>4</code>, <code>5</code>, <code>6</code>, or <code>7</code>. What we will do is create a binary tree of decisions, where we will train a binary classifier for each of the nodes. The decisions of each classifier will determine the path that we will walk down the tree, and downstream branches will progressively narrow the set of possible choices. The leaves of this tree represent single classes, and the decision of the overall classifier.</p>
<p>Graphically, it looks like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cscheid.net/v2/explainers/ecoc-binary-tree.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">A binary tree to convert single-class predictors into multi-class predictors.</figcaption><p></p>
</figure>
</div>
<p>If you compare this scheme to the OVA and AVA ideas, you can notice a few similarities and a few differences.</p>
<p>First, the number of classifiers you need to train in this scheme is comparable to that of OVA (in a binary tree with <img src="https://latex.codecogs.com/png.latex?k"> leaves, there are always <img src="https://latex.codecogs.com/png.latex?k-1"> nodes).</p>
<p>In OVA, all classifiers are unbalanced, in that you’re training “class-<img src="https://latex.codecogs.com/png.latex?i"> vs.&nbsp;class-not-<img src="https://latex.codecogs.com/png.latex?i">” subproblems. Here, your classification problems are all balanced. The leaves of the binary tree classifier are identical to some of the AVA classifiers, but the internal nodes combine multiple classes. This can be both good and bad: it’s bad in that if you have multiple classes that look very different from one another, you’ll be trying to “teach your classifier more than one thing at once”. That’s not great. But if the classes in the same side of the internal nodes are similar enough, then combining them means that the training process for that node will be able to “share knowledge from its lessons”. And that’s a good thing.</p>
<p>Unlike OVA or AVA, the number of decisions you need to make at test time is quite small. Here, the path from the tree root to a leaf has <img src="https://latex.codecogs.com/png.latex?O(%5Clog%20k)"> nodes, while OVA needs <img src="https://latex.codecogs.com/png.latex?O(k)"> classifiers, and AVA, <img src="https://latex.codecogs.com/png.latex?O(k%5E2)">. This means that if your binary classifiers achieve an error rate of <img src="https://latex.codecogs.com/png.latex?%5Cepsilon">, then you can trivially see that the multiclass classifier will achieve an error rate of <img src="https://latex.codecogs.com/png.latex?O(%5Clog%20k)%20%5Cepsilon">.</p>
</section>
<section id="reducing-the-number-of-base-classifiers" class="level2">
<h2 class="anchored" data-anchor-id="reducing-the-number-of-base-classifiers">Reducing the number of base classifiers</h2>
<p>Now let’s make things a little weird. Say that you think your base binary classifier procedure is so good, that it will be able to distinguish between <em>any</em> partition of classes from the original problem that you give it. What’s the minimum number of classifiers you have to train? It is easy to see what that number must be. If you think of the decision of the final multiclass classifier as producing a word in binary, then clearly we need <img src="https://latex.codecogs.com/png.latex?O(%5Clog_2%20k)"> binary digits to write out that word. But a binary digit is the best we can get out of a binary classifier, so we need <img src="https://latex.codecogs.com/png.latex?O(%5Clog_2%20k)"> of them as well.</p>
<p>This also clearly suggests the way to build the classifier: write out the multiple class labels in binary representation, and now the job of the <img src="https://latex.codecogs.com/png.latex?i">-th of <img src="https://latex.codecogs.com/png.latex?%5Clog_2%20k"> binary classifiers is to predict the <img src="https://latex.codecogs.com/png.latex?i">-th digit of that binary representation. This is the same thing as building, for each of the level of the trees in the above example, a <em>single classifier</em>, where that classifier predicts whether to take the branch on the left or the right.</p>
<p>In other words, for the same 8-class problem we had before, we build classifiers that distinguish between:</p>
<ul>
<li><code>0123</code> vs.&nbsp;<code>4567</code></li>
<li><code>0145</code> vs.&nbsp;<code>2367</code></li>
<li><code>0246</code> vs.&nbsp;<code>1357</code></li>
</ul>
<p>Notice how there’s only one class that’s unique along any possible set of decisions of the binary classifiers. Let’s call this the “binary transmission” method (TODO: find the actual name used in ML).</p>
</section>
<section id="the-magic-of-error-correction" class="level1">
<h1>The magic of error correction</h1>
<p>This is pretty neat, but it turns out that the best is still ahead of us! The main thing we will address now is that it’s not always the case that our classifiers will be correct. And unlike the case with AVA and OVA, base-level mistakes in the binary tree and binary transmission methods are always catastrophic.</p>
<p>The problem of transmitting information in the presence of noise has been deeply studied since the early 20th century. The most magical thing about changing perspectives is that it instantly gives us a lot of new tools to think about a problem. So what if we pretend that each binary classifier is sending its result along a telegraph, in which mistakes can happen along the way? Then, the problem of fixing a transmission mistake looks equivalent to the problem of making a classifier error. So, <em>if we can fix a transmission mistake even if every digit can fail, we might be able to fix a multiclassifier mistake, even if every binary classifier can fail!</em>.</p>
<p>In the following, we will look at a very simple error-correcting code. The <a href="http://hunch.net/~beygel/tournament.pdf">state of the art for error correcting in multiclass classifiers</a> is much more complicated than this, but the principle is the same.</p>
<p>The idea itself behind error correcting codes is simple. Say we want to transmit a word that can be one of <code>000</code>, <code>001</code>, <code>010</code>, <code>011</code>, <code>100</code>, <code>101</code>, <code>110</code>, or <code>111</code>. We will model a transmission error as flipping one of the bits of those words. If we send this representation directly, then any errors that happen in the transmission will become indistinguishable from a successful transmission of a different message. This is a problem, because we won’t even know when something bad happens. It needs to be possible for our communication process to know, by looking at the transmitted word, that something wrong happened. So there needs to be enough <em>room</em> in the space of possible messages for the case where “bad stuff happened”. This means that we will have to <em>encode</em> the word we want to send into a bigger space of possible transmissions, a space with more room.</p>
<p>In addition, in this new space of possible transmission, every codeword should be far away from one another (where we <a href="https://en.wikipedia.org/wiki/Hamming_distance">measure distance by flipping bits</a>, the same process that we assume was introducing mistakes), because we want to give every codeword a “safety cushion” for errors, so that if we get a bad transmission, there’s only one codeword nearby, so we will know how to correct that mistake.</p>
<p>There are simple error detection methods, like sending the same message three times. If any of the words disagree with one another, then we know a mistake happened somewhere (and we correct it by majority voting).</p>
<p>This, however, is not a very efficient code, and most importantly, it will not work in the case of multiclass classification! When sending messages on radio, each error happens (<a href="https://en.wikipedia.org/wiki/Burst_error">well, kinda</a>) independently of one another. But in our case, a mistake happens when a classifier does badly for a given example. So if we just try to “send the same digit three times”, it’ll be the case that if we make a mistake once, then we will make it three times! We need to come up with a better method. (Specifically, I will describe below the <a href="https://en.wikipedia.org/wiki/Hamming(7,4)">Hamming(7,4) code</a>.)</p>
<section id="lets-not-repeat-digits" class="level2">
<h2 class="anchored" data-anchor-id="lets-not-repeat-digits">Let’s not repeat digits</h2>
<p>The code I’m going to describe to you works on 4-bit words, so for now let’s pretend that our original problem had 16 classes instead of 8. The encoding process is itself very easy to describe. We send the 4-bit word into a 7-bit space:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?A%20=%20d%5C_1%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_2%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4"></li>
<li><img src="https://latex.codecogs.com/png.latex?B%20=%20d%5C_1%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_3%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4"></li>
<li><img src="https://latex.codecogs.com/png.latex?C%20=%20d%5C_2%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_3%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4"></li>
<li><img src="https://latex.codecogs.com/png.latex?D%20=%20d%5C_1"></li>
<li><img src="https://latex.codecogs.com/png.latex?E%20=%20d%5C_2"></li>
<li><img src="https://latex.codecogs.com/png.latex?F%20=%20d%5C_3"></li>
<li><img src="https://latex.codecogs.com/png.latex?G%20=%20d%5C_4"></li>
</ul>
<p>Here, <img src="https://latex.codecogs.com/png.latex?d%5C_1"> through <img src="https://latex.codecogs.com/png.latex?d%5C_4"> are the digits of the word we want to send. As we argued above, it must be the case that this code is redundant. Indeed, any valid word respects the following equations:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?A%5C%20%5Ctextrm%7Bxor%7D%5C%20D%5C%20%5Ctextrm%7Bxor%7D%5C%20E%5C%20%5Ctextrm%7Bxor%7D%5C%20G%20=%200"></li>
<li><img src="https://latex.codecogs.com/png.latex?B%5C%20%5Ctextrm%7Bxor%7D%5C%20D%5C%20%5Ctextrm%7Bxor%7D%5C%20F%5C%20%5Ctextrm%7Bxor%7D%5C%20G%20=%200"></li>
<li><img src="https://latex.codecogs.com/png.latex?C%5C%20%5Ctextrm%7Bxor%7D%5C%20E%5C%20%5Ctextrm%7Bxor%7D%5C%20F%5C%20%5Ctextrm%7Bxor%7D%5C%20G%20=%200"></li>
</ul>
<p>These equations are easy to prove: remember that <img src="https://latex.codecogs.com/png.latex?%5Ctextrm%7Bxor%7D"> is commutatitive and associative, and that <img src="https://latex.codecogs.com/png.latex?a%5C%20%5Ctextrm%7Bxor%7D%5C%20a%20=%200">. Moreover, the equations are also the key to making error detection work. Here’s a minor modification we will make. Let’s assume that an error can happen on any digit we send, so we replace <img src="https://latex.codecogs.com/png.latex?A"> with <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BA%7D">, etc:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BA%7D%20=%20%5Cepsilon_A%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_1%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_2%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BB%7D%20=%20%5Cepsilon_B%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_1%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_3%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BC%7D%20=%20%5Cepsilon_C%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_2%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_3%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BD%7D%20=%20%5Cepsilon_D%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_1"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BE%7D%20=%20%5Cepsilon_E%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_2"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BF%7D%20=%20%5Cepsilon_F%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_3"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BG%7D%20=%20%5Cepsilon_G%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4"></li>
</ul>
<p>Here, we use <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%5C_A">, <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%5C_B">, etc. to model errors in our transmission. The code we are describing here can only correct mistakes if only one of them happens at a time. That means that for every transmission, either <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%5C_A%20=%20%5Cepsilon%5C_B%20=%20%5Ccdots%20=%200">, or a single one of the <img src="https://latex.codecogs.com/png.latex?%5Cepsilon"> variables is one and all the others are still zero.</p>
<p>This is where the magic happens. Let’s say <img src="https://latex.codecogs.com/png.latex?%5Cepsilon_A%20=%201">. Although it seems like it will be hard to figure out that something went wrong (since the 7-bit word we transmitted “looks fine”), let’s look at those three equations that we derived which describe the redundancy in the code. Now, consider their equivalents with <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BA%7D">, etc. I’m also giving each term a name now, <img src="https://latex.codecogs.com/png.latex?c%5C_0"> through <img src="https://latex.codecogs.com/png.latex?c%5C_2">:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?c%5C_0%20=%20%5Ctilde%7BA%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Ctilde%7BD%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Ctilde%7BE%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Ctilde%7BG%7D%20=%20%5Cepsilon%5C_%7BA%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Cepsilon%5C_%7BD%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Cepsilon%5C_%7BE%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Cepsilon%5C_%7BG%7D"></li>
<li><img src="https://latex.codecogs.com/png.latex?c%5C_1%20=%20%5Ctilde%7BB%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Ctilde%7BD%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Ctilde%7BF%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Ctilde%7BG%7D%20=%20%5Cepsilon%5C_%7BB%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Cepsilon%5C_%7BD%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Cepsilon%5C_%7BF%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Cepsilon%5C_%7BG%7D"></li>
<li><img src="https://latex.codecogs.com/png.latex?c%5C_2%20=%20%5Ctilde%7BC%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Ctilde%7BE%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Ctilde%7BF%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Ctilde%7BG%7D%20=%20%5Cepsilon%5C_%7BC%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Cepsilon%5C_%7BE%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Cepsilon%5C_%7BF%7D%5C%20%5Ctextrm%7Bxor%7D%5C%20%5Cepsilon%5C_%7BG%7D"></li>
</ul>
<p>Notice two very important things on the right hand sides: every error variable appears at least once, and no error variable was cancelled out from appearing more than once in the left-hand sides.</p>
<p>There’s also a less immediate property of these <img src="https://latex.codecogs.com/png.latex?c"> variables: <em>every possible mistake case creates a different configuration of <img src="https://latex.codecogs.com/png.latex?c%5C_0">, <img src="https://latex.codecogs.com/png.latex?c%5C_1">, and <img src="https://latex.codecogs.com/png.latex?c%5C_2"></em>! This is truly remarkable, and you should check it for yourself, by setting the values of <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%5C_A"> through <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%5C_G"> to 1. For example, you should be able to convince yourself that if <img src="https://latex.codecogs.com/png.latex?c%5C_0%20=%200">, <img src="https://latex.codecogs.com/png.latex?c%5C_1%20=%201">, and <img src="https://latex.codecogs.com/png.latex?c%5C_2%20=%201">, then it must be the case that <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%5C_%7BF%7D%20=%201">, which means that the mistake happened on <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BF%7D">, which in turn means that all we have to do is flip <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BF%7D"> to obtain <img src="https://latex.codecogs.com/png.latex?F">, and all other digits must be correct! If all <img src="https://latex.codecogs.com/png.latex?c">s are zero, then no error happened. (Again, we are assuming that errors happen only one at a time. Fate is not always this kind.)</p>
</section>
<section id="now-to-turn-this-into-a-multiclass-reduction" class="level2">
<h2 class="anchored" data-anchor-id="now-to-turn-this-into-a-multiclass-reduction">Now to turn this into a multiclass reduction</h2>
<p>The final remarkable property of this error-correcting code is that each digit in the new transmission is formed by a particular combination of the digits in the original problem. Let’s think of the binary classification problems in the “binary transmission” reduction. (Here, I’ll slip into hexadecimal notation and call the 16 classes <code>0123456789abcdef</code>):</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?d_1">: <tt>01234567&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt> vs.&nbsp;the negative: <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;89abcdef</tt></li>
<li><img src="https://latex.codecogs.com/png.latex?d_2">: <tt>0123&nbsp;&nbsp;&nbsp;&nbsp;89ab&nbsp;&nbsp;&nbsp;</tt> vs.&nbsp;the negative: <tt>&nbsp;&nbsp;&nbsp;&nbsp;4567&nbsp;&nbsp;&nbsp;&nbsp;cdef</tt></li>
<li><img src="https://latex.codecogs.com/png.latex?d_3">: <tt>01&nbsp;&nbsp;45&nbsp;&nbsp;89&nbsp;&nbsp;cd&nbsp;</tt> vs.&nbsp;the negative: <tt>&nbsp;&nbsp;23&nbsp;&nbsp;67&nbsp;&nbsp;ab&nbsp;&nbsp;ef</tt></li>
<li><img src="https://latex.codecogs.com/png.latex?d_4">: <tt>0&nbsp;2&nbsp;4&nbsp;6&nbsp;8&nbsp;a&nbsp;c&nbsp;e</tt> vs.&nbsp;the negative: <tt>&nbsp;1&nbsp;3&nbsp;5&nbsp;7&nbsp;9&nbsp;b&nbsp;d&nbsp;f</tt></li>
</ul>
<p>(The whitespace is there simply to make the logic more apparent.) These are our “base-digits” classifiers. The “checksum-digit” classifiers, that is, the redundant classifiers we will build to let us fix mistakes, will use the <img src="https://latex.codecogs.com/png.latex?%5Ctextrm%7Bxor%7D"> operation as well. Concretely speaking, the classifier for <img src="https://latex.codecogs.com/png.latex?d%5C_1%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_2%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4"> (that is, our transmitted digit <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BA%7D"> above) should return a positive label when <img src="https://latex.codecogs.com/png.latex?d%5C_1%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_2%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4%20=%201">, or equivalently, it should separate the classes <code>02579bce</code> from <code>13468adf</code>.</p>
<p>Take a moment to convince yourself of why that makes sense: that split separates the classes that appear in <img src="https://latex.codecogs.com/png.latex?d%5C_1">, <img src="https://latex.codecogs.com/png.latex?d%5C_2">, or <img src="https://latex.codecogs.com/png.latex?d%5C_4"> an odd number of times from those that appear there an even number of times. In other words, this classifier will “attempt to send 1” if <img src="https://latex.codecogs.com/png.latex?d%5C_1%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_2%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4%20=%201">, and “attempt to send 0” if <img src="https://latex.codecogs.com/png.latex?d%5C_1%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_2%5C%20%5Ctextrm%7Bxor%7D%5C%20d%5C_4%20=%200">, <em>exactly like our communication example!</em></p>
<p>Now, every time any one of our classifiers makes an isolated mistake, we will be able to spot it and fix it, at the expense of training only three more classifiers. And all of these classifiers are trained on different label distributions, and so we don’t run into the issue of repeated classification mistakes (like we would if we used the “repeat transmission” code).</p>
<p>Isn’t that amazing?</p>
</section>
</section>
<section id="further-reading" class="level1">
<h1>Further reading</h1>
<p>There are a number of details that have to be handled when actually deploying this strategy. The main one is that the choice on how to order the classes to create those splits is quite important, both because we need the individual classifiers to be good, and because we need digit errors to be relatively uncorrelated to one another.</p>
<p>In practice, what the literature suggests is to <em>invent a new custom code for every multiclass classification problem</em>. This is easier than it looks, and if you’re interested, then Dietterich and Bakiri’s <a href="https://arxiv.org/pdf/cs/9501101.pdf">seminal paper</a> is what you should read next. This technique is now known as ECOC (“error-correcting output codes”).</p>
<p>The question of whether ECOC’s are the best we can do remained open for a while, and although it’s still not completely settled, a (much more complicated) solution that combines error correction with the binary tournament idea from above gets pretty close to optimal. These are <a href="https://arxiv.org/abs/0902.3176">error-correcting tournaments</a>, proposed by Beygelzimer et al.&nbsp;I confess I don’t actually understand ECTs all that well, but the good news is that at least they’re implemented in <a href="https://github.com/VowpalWabbit/vowpal_wabbit">Vowpal Wabbit</a>. If each of the base classifiers achieves an average error rate of <img src="https://latex.codecogs.com/png.latex?%5Cepsilon">, error-correcting tournaments achieve a multiclass error bound of <img src="https://latex.codecogs.com/png.latex?2%20%5Cepsilon">. This is independent of the number of classes in the multiclass problem, which is quite incredible.</p>
<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes</h2>
<ul>
<li>The reason we can’t use the “repeat the same message more than once” trick is that we assumed we were always training the same classifier. If you have two binary classifiers for the same problem that both predict reasonably well, and whose predictions are relatively uncorrelated, then you can absolutely use this “repeat message” method. This turns out to work <a href="https://en.wikipedia.org/wiki/Bootstrap_aggregating">incredibly well in practice</a>!</li>
</ul>


<!-- -->

</section>
</section>

 ]]></description>
  <category>explainers</category>
  <category>data-science</category>
  <guid>https://cscheid.net/v2/explainers/ecoc.html</guid>
  <pubDate>Wed, 01 Jan 2020 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/explainers/ecoc-binary-tree.png" medium="image" type="image/png" height="63" width="144"/>
</item>
<item>
  <title>Multidimensional Scaling</title>
  <link>https://cscheid.net/v2/explainers/mds.html</link>
  <description><![CDATA[ 



<p>“Multidimensional Scaling” techniques turn measurements of similarities (or distances) into <strong>coordinates</strong> of points in a low-dimensional space, usually 2D of 3D.</p>
<section id="classical-mds" class="level2">
<h2 class="anchored" data-anchor-id="classical-mds">Classical MDS</h2>
<p>There are many variants of “multidimensional scaling”, with different assumptions on the measurements, and different ways to reconstruct the values. Here we will focus on the very simplest of them, typically known as “Classical” multidimensional scaling, or CMDS. For more, the best reference is Borg and Groenen’s Modern Multidimensional Scaling<sup>1</sup>.</p>
</section>
<section id="from-distances" class="level2">
<h2 class="anchored" data-anchor-id="from-distances">From distances</h2>
<p>Imagine that, instead of knowing the coordinates of a set of points, all you knew were the distance from each point to each other point. Intuitively, it seems like it should be possible to convert this information back into coordinates which respect the distances. Consider the simplest case of three points A, B, and C, and that we know that</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5Cbegin%7Baligned%7D%20d(A,B)%20&amp;=%203%20%5C%5C%20d(A,C)%20&amp;=%204%20%5C%5C%20d(B,C)%20&amp;=%205%20%5Cend%7Baligned%7D%20"></p>
<p>We instantly recognize those distances as forming a right triangle, and so a possible solution is <img src="https://latex.codecogs.com/png.latex?A%20=%20(0,0),%20B%20=%20(3,0),%20C%20=%20(0,%204)">. Note, however, that, there is more than one possible set of coordinates for that triangle. We could move it around the plane, we could rotate it, and we could flip it.</p>
<p>So, just remember that MDS generally will give <em>one</em> possible set of coordinates, instead of a unique one. But how does it do that?</p>
<p>Let’s start with the description of the algorithm:</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?D%20=%20(%7C%7CX_i%20-%20X_j%7C%7C%5E2)_%7Bij%7D">: let <img src="https://latex.codecogs.com/png.latex?D"> be a matrix that stores the <strong>squared</strong> distance from point <img src="https://latex.codecogs.com/png.latex?i"> to point <img src="https://latex.codecogs.com/png.latex?j"> (notice that we do not currently have the <img src="https://latex.codecogs.com/png.latex?X_i"> and <img src="https://latex.codecogs.com/png.latex?X_j"> vectors; we’re just using the notation to say what the entries of the matrix should store.</li>
<li><img src="https://latex.codecogs.com/png.latex?P%20=%20(-1/2)%20H%20D%20H">: let <img src="https://latex.codecogs.com/png.latex?P"> be a row- and column-centered version of <img src="https://latex.codecogs.com/png.latex?D">, multiplied by <img src="https://latex.codecogs.com/png.latex?-1/2"> (<img src="https://latex.codecogs.com/png.latex?H"> is the centering matrix, as described in the <a href="pca.html">PCA</a> section).</li>
<li>Let <img src="https://latex.codecogs.com/png.latex?P%20=%20U%20%5CLambda%20U%5ET">.</li>
<li>The coordinates of <img src="https://latex.codecogs.com/png.latex?X"> are given by the first few columns of <img src="https://latex.codecogs.com/png.latex?U%20%5CLambda%5E%7B1/2%7D">.</li>
</ol>
<p>The decision of how many coordinates to use for the MDS is similar to the decision of how many principal components to choose. As we go down the diagonal values of <img src="https://latex.codecogs.com/png.latex?%5CLambda">, the values will get closer to zero (and we assume that they are sorted from largest to smallest). We will usually drop some columns, which is the same as setting some values in <img src="https://latex.codecogs.com/png.latex?%5CLambda"> to zero. The smaller these non-zero values were, the more precise the result of the MDS will be (that is, the squared distance between <img src="https://latex.codecogs.com/png.latex?X_i"> and <img src="https://latex.codecogs.com/png.latex?X_j"> will become closer to the actual value in <img src="https://latex.codecogs.com/png.latex?D_%7Bij%7D">).</p>
<p>In fact, the easiest way to understand how CMDS works is to compare it directly to PCA. Specifically, let’s look at what happens if we started from an actual matrix <img src="https://latex.codecogs.com/png.latex?X"> from which to build <img src="https://latex.codecogs.com/png.latex?D">. In this case,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%20D_%7Bij%7D%20&amp;=&amp;%20%7C%7C%20X_i%20-%20X_j%20%7C%7C%5E2%20%5C%5C%20D_%7Bij%7D%20&amp;=&amp;%20%5Clangle%20X_i%20-%20X_j,%20X_i%20-%20X_j%20%5Crangle%5C%5C%20D_%7Bij%7D%20&amp;=&amp;%20%5Clangle%20X_i,%20X_i%20%5Crangle%20+%20%5Clangle%20X_j,%20X_j%20%5Crangle%20-%202%20%5Clangle%20X_i,%20X_j%20%5Crangle.%20%5Cend%7Balign%7D"></p>
<p>So what we get is that every entry <img src="https://latex.codecogs.com/png.latex?i,%20j"> of the matrix <img src="https://latex.codecogs.com/png.latex?D"> can be represented by a sum of three terms. So we write the matrix <img src="https://latex.codecogs.com/png.latex?D"> as a sum of three matrices:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%20D%20&amp;=&amp;%20(%5Clangle%20X_i,%20X_i%20%5Crangle)_%7Bij%7D%20+%20(%5Clangle%20X_j,%20X_j%20%5Crangle)_%7Bij%7D%20+%20(-2%20%5Clangle%20X_i,%20X_j%20%5Crangle)_%7Bij%7D%5C%5C%20D%20&amp;=&amp;%20A%20+%20B%20+%20C%5Cend%7Balign%7D"></p>
<p>Now we follow step 2 of the algorithm above, and let</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%20P%20&amp;=&amp;%20-1/2%20H%20D%20H%20%5C%5C%20P%20&amp;=&amp;%20-1/2%20H%20(A%20+%20B%20+%20C)%20H%20%5C%5C%20P%20&amp;=&amp;%20-(1/2)%20H%20A%20H%20-(1/2)%20H%20B%20H%20-(1/2)%20H%20C%20H%20%5Cend%7Balign%7D"></p>
<p>Now note that all of the columns of <img src="https://latex.codecogs.com/png.latex?A"> are identical, because the values only depend on the row index <img src="https://latex.codecogs.com/png.latex?i">. Similarly, all of the rows in <img src="https://latex.codecogs.com/png.latex?B"> are identical, because the values only depend on the column index <img src="https://latex.codecogs.com/png.latex?j">. This means that <img src="https://latex.codecogs.com/png.latex?HAH%20=%20HBH%20=%200">!, since column-centering <img src="https://latex.codecogs.com/png.latex?A"> will subtract the average column value; the analogous thing happens to row-centering <img src="https://latex.codecogs.com/png.latex?B">. As a result,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%20P%20&amp;=&amp;%20-1/2%20H%20D%20H%20%5C%5C%20P%20&amp;=&amp;%20H%20(%5Clangle%20X_i,%20X_j)_%7Bij%7D%20%5Crangle%20H%20%5Cend%7Balign%7D"></p>
<p>So our <img src="https://latex.codecogs.com/png.latex?P"> matrix is now exactly equal to a centered matrix of inner products of <img src="https://latex.codecogs.com/png.latex?X">, even though we never used the inner products directly – all we had access to was squared distances. So if we take <img src="https://latex.codecogs.com/png.latex?P"> to be the matrix <img src="https://latex.codecogs.com/png.latex?M"> on step 3 of our <!-- [second PCA algorithm](pca.html#PCA%20%through%20%a%20matrix%20of%20inner%20products), --> we get to recover <img src="https://latex.codecogs.com/png.latex?X"> exactly! This is really neat.</p>
</section>
<section id="from-similarities" class="level2">
<h2 class="anchored" data-anchor-id="from-similarities">From similarities</h2>
<p>The same algorithm also applies directly when all we have access to is a notion of <strong>similarity</strong> between points. Here the idea is even simpler. Let’s say that we have a way to give a numerical value of similarity between points such that if two points are similar to each other, the value is relatively large, and if two points are relatively dissimilar, the value is relatively small. Then we can pretend that this value is “like an inner product”, create a matrix of similarities, center the matrix in both rows and columns, and just compute the PCA directly like above. This will actually recover good coordinates the respect the similarities!</p>
</section>
<section id="references" class="level1">
<h1>References</h1>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Borg, I. and Groenen, P.J.F. (2005). <a href="http://people.few.eur.nl/groenen/mmds/">Modern multidimensional scaling. 2nd edition</a>. New York: Springer.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>mathematics</category>
  <category>data-science</category>
  <guid>https://cscheid.net/v2/explainers/mds.html</guid>
  <pubDate>Wed, 01 Jan 2020 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Variations on the Hermann grid</title>
  <link>https://cscheid.net/v2/hacks/variations-on-the-hermann-grid.html</link>
  <description><![CDATA[ 



<p>The <a href="https://www.illusionsindex.org/i/hermann-grid">Hermann grid</a> is the prototypical example of the extinction illusion. Here we build a small variation of Figure 5 from <a href="http://journals.sagepub.com/doi/abs/10.1068/p2985">Ninio and Stevens’s Variations on the Hermann Grid: An Extinction Illusion</a>. There are equally many points on either half of the image: the animation simply moves the points vertically.</p>
<div id="main">

</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="16" data-source-offset="-0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 15;"><span id="cb1-16"><span class="im" style="color: #00769E;">import</span> { svg <span class="im" style="color: #00769E;">as</span> _svg } <span class="im" style="color: #00769E;">from</span> <span class="st" style="color: #20794D;">"/src/cscheid/cscheid.js"</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-17"></span>
<span id="cb1-18">{</span>
<span id="cb1-19">    <span class="kw" style="color: #003B4F;">var</span> svg <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"#main"</span>)</span>
<span id="cb1-20">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"svg"</span>)</span>
<span id="cb1-21">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">600</span>)</span>
<span id="cb1-22">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">600</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-23"></span>
<span id="cb1-24">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">addLineGrid</span>(parent)</span>
<span id="cb1-25">    {</span>
<span id="cb1-26">    <span class="cf" style="color: #003B4F;">return</span> parent<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-27">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-28">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">20</span>))</span>
<span id="cb1-29">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-30">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-31">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">300</span>)</span>
<span id="cb1-32">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">900</span>)</span>
<span id="cb1-33">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y1"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">40</span>)</span>
<span id="cb1-34">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y2"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">40</span>)</span>
<span id="cb1-35">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"gray"</span>)</span>
<span id="cb1-36">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"5px"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-37">    }</span>
<span id="cb1-38"></span>
<span id="cb1-39">    <span class="co" style="color: #5E5E5E;">// ugly</span></span>
<span id="cb1-40">    <span class="fu" style="color: #4758AB;">addLineGrid</span>(svg)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(320, 320) rotate(90)  translate(-320, -320)"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-41">    <span class="fu" style="color: #4758AB;">addLineGrid</span>(svg)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(320, 320) rotate(30)  translate(-320, -320)"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-42">    <span class="fu" style="color: #4758AB;">addLineGrid</span>(svg)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(320, 320) rotate(150) translate(-320, -320)"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-43"></span>
<span id="cb1-44">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">addPoints</span>(parent)</span>
<span id="cb1-45">    {</span>
<span id="cb1-46">    <span class="cf" style="color: #003B4F;">return</span> parent<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-47">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-48">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">16</span>))</span>
<span id="cb1-49">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-50">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-51">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"5px"</span>)</span>
<span id="cb1-52">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb1-53">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"white"</span>)</span>
<span id="cb1-54">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-55">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">40</span> <span class="op" style="color: #5E5E5E;">/</span> (<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sqrt</span>(<span class="dv" style="color: #AD0000;">3</span>) <span class="op" style="color: #5E5E5E;">/</span> <span class="dv" style="color: #AD0000;">2</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-56">    }</span>
<span id="cb1-57"></span>
<span id="cb1-58">    <span class="kw" style="color: #003B4F;">var</span> gap <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">/</span>(<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sqrt</span>(<span class="dv" style="color: #AD0000;">3</span>)<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-59"></span>
<span id="cb1-60">    <span class="kw" style="color: #003B4F;">var</span> left <span class="op" style="color: #5E5E5E;">=</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="dv" style="color: #AD0000;">4</span>))</span>
<span id="cb1-61">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-62">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> _svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">translate</span>(<span class="dv" style="color: #AD0000;">40</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">80</span> <span class="op" style="color: #5E5E5E;">*</span> d<span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span>))</span>
<span id="cb1-63">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">call</span>(addPoints)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-64"></span>
<span id="cb1-65">    <span class="kw" style="color: #003B4F;">var</span> right <span class="op" style="color: #5E5E5E;">=</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="dv" style="color: #AD0000;">4</span>))</span>
<span id="cb1-66">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-67">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> _svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">translate</span>(<span class="dv" style="color: #AD0000;">560</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">80</span> <span class="op" style="color: #5E5E5E;">*</span> d<span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">+</span>gap))</span>
<span id="cb1-68">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">call</span>(addPoints)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-69"></span>
<span id="cb1-70">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">moveLeft</span>()</span>
<span id="cb1-71">    {</span>
<span id="cb1-72">    left<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-73">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">delay</span>(<span class="dv" style="color: #AD0000;">1500</span>)</span>
<span id="cb1-74">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1500</span>)</span>
<span id="cb1-75">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> _svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">translate</span>(<span class="dv" style="color: #AD0000;">40</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">80</span> <span class="op" style="color: #5E5E5E;">*</span> d<span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">+</span>gap<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span>))</span>
<span id="cb1-76">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-77">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">delay</span>(<span class="dv" style="color: #AD0000;">1500</span>)</span>
<span id="cb1-78">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1500</span>)</span>
<span id="cb1-79">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> _svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">translate</span>(<span class="dv" style="color: #AD0000;">40</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">80</span> <span class="op" style="color: #5E5E5E;">*</span> d<span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span>))</span>
<span id="cb1-80">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> moveLeft)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-81">    }</span>
<span id="cb1-82"></span>
<span id="cb1-83">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">moveRight</span>()</span>
<span id="cb1-84">    {</span>
<span id="cb1-85">    right<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-86">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">delay</span>(<span class="dv" style="color: #AD0000;">1500</span>)</span>
<span id="cb1-87">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1500</span>)</span>
<span id="cb1-88">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> _svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">translate</span>(<span class="dv" style="color: #AD0000;">560</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">80</span> <span class="op" style="color: #5E5E5E;">*</span> d<span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">*</span>gap<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span>))</span>
<span id="cb1-89">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-90">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">delay</span>(<span class="dv" style="color: #AD0000;">1500</span>)</span>
<span id="cb1-91">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1500</span>)</span>
<span id="cb1-92">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> _svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">translate</span>(<span class="dv" style="color: #AD0000;">560</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">80</span> <span class="op" style="color: #5E5E5E;">*</span> d<span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">+</span>gap))</span>
<span id="cb1-93">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> moveRight)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-94">    }</span>
<span id="cb1-95"></span>
<span id="cb1-96">    <span class="fu" style="color: #4758AB;">moveLeft</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-97">    <span class="bu" style="color: null;">window</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">setTimeout</span>(moveRight<span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">750</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-98"></span>
<span id="cb1-99">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>I found out about the static version of this illusion <a href="https://twitter.com/chazfirestone/status/1049312925134020610">on twitter</a>.</p>


<!-- -->

</section>

 ]]></description>
  <category>optical-illusion</category>
  <guid>https://cscheid.net/v2/hacks/variations-on-the-hermann-grid.html</guid>
  <pubDate>Sat, 13 Oct 2018 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/images/variations-on-the-hermann-grid.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Purple dots</title>
  <link>https://cscheid.net/v2/hacks/purple-dots.html</link>
  <description><![CDATA[ 



<p>If you keep your gaze focused at the black crosshairs, eventually the purple dots fade away and you start seeing an animated bright green dot instead.</p>
<div id="wrapper">

</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="14" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 13;"><span id="cb1-14">{</span>
<span id="cb1-15">    <span class="kw" style="color: #003B4F;">var</span> svgMain <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"#wrapper"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"svg"</span>)</span>
<span id="cb1-16">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"viewBox"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"0 0 600 600"</span>)</span>
<span id="cb1-17">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"100%"</span>)</span>
<span id="cb1-18">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"100%"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-19"></span>
<span id="cb1-20">    svgMain<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"defs"</span>)</span>
<span id="cb1-21">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"filter"</span>)</span>
<span id="cb1-22">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"id"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"blur1"</span>)</span>
<span id="cb1-23">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"-50%"</span>)</span>
<span id="cb1-24">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"-50%"</span>)</span>
<span id="cb1-25">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"200%"</span>)</span>
<span id="cb1-26">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"200%"</span>)</span>
<span id="cb1-27">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"feGaussianBlur"</span>)</span>
<span id="cb1-28">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"in"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"SourceGraphic"</span>)</span>
<span id="cb1-29">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stdDeviation"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"5"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-30"></span>
<span id="cb1-31">    svgMain <span class="op" style="color: #5E5E5E;">=</span> svgMain</span>
<span id="cb1-32">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-33">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(300, 300)"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-34"></span>
<span id="cb1-35">    svgMain<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-36">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"path"</span>)</span>
<span id="cb1-37">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb1-38">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"none"</span>)</span>
<span id="cb1-39">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"d"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"M -20 0 L 20 0 M 0 -20 L 0 20"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-40"></span>
<span id="cb1-41">    <span class="kw" style="color: #003B4F;">let</span> nPoints <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">12</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-42">    <span class="kw" style="color: #003B4F;">let</span> angles <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> nPoints)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">map</span>((a) <span class="kw" style="color: #003B4F;">=&gt;</span> (a <span class="op" style="color: #5E5E5E;">/</span> nPoints) <span class="op" style="color: #5E5E5E;">*</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">2</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-43"></span>
<span id="cb1-44">    <span class="kw" style="color: #003B4F;">var</span> circles <span class="op" style="color: #5E5E5E;">=</span> svgMain<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-45">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-46">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(angles)</span>
<span id="cb1-47">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-48">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-49">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">15</span>)</span>
<span id="cb1-50">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">style</span>(<span class="st" style="color: #20794D;">"filter"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"url(#blur1)"</span>)</span>
<span id="cb1-51">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> (d) <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(d) <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">210</span>)</span>
<span id="cb1-52">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> (d) <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(d) <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">210</span>)</span>
<span id="cb1-53">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">70</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">50</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-54"></span>
<span id="cb1-55">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">startLoop</span>(d) {</span>
<span id="cb1-56">    d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="kw" style="color: #003B4F;">this</span>)</span>
<span id="cb1-57">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-58">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">150</span>)</span>
<span id="cb1-59">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">style</span>(<span class="st" style="color: #20794D;">"opacity"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-60">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-61">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">150</span>)</span>
<span id="cb1-62">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">style</span>(<span class="st" style="color: #20794D;">"opacity"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>)</span>
<span id="cb1-63">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-64">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">delay</span>(<span class="dv" style="color: #AD0000;">700</span>)</span>
<span id="cb1-65">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> startLoop)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-66">    }</span>
<span id="cb1-67"></span>
<span id="cb1-68">    circles<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-69">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">delay</span>((d) <span class="kw" style="color: #003B4F;">=&gt;</span> (d <span class="op" style="color: #5E5E5E;">/</span> (<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">2</span>)) <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">1000</span>)</span>
<span id="cb1-70">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> startLoop)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-71">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>I tried to track down the original discoverer of this one but ultimately failed; it seems at this point to be folklore.</p>


<!-- -->

</section>

 ]]></description>
  <category>optical-illusion</category>
  <guid>https://cscheid.net/v2/hacks/purple-dots.html</guid>
  <pubDate>Thu, 27 Sep 2018 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/images/purple-dots.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Ring with rotating gap</title>
  <link>https://cscheid.net/v2/hacks/ring-gap.html</link>
  <description><![CDATA[ 



<p>This is a continuous version of the <a href="../hacks/purple-dots.html">purple dots illusion</a>. Keep staring at the crosshairs. Eventually, instead of a white gap rotating, you’ll start seeing a bright band of the opponent color.</p>
<p>Incidentally, you’ll notice that this opponent color is quite bright - it in fact appears brighter than the white background of your display! This is because you’re experiencing a <a href="https://en.wikipedia.org/wiki/Impossible_color">Chimerical color</a>.</p>
<div id="main" style="height: 600px">

</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="21" data-source-offset="-0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 20;"><span id="cb1-21"><span class="im" style="color: #00769E;">import</span> { dom<span class="op" style="color: #5E5E5E;">,</span> time } <span class="im" style="color: #00769E;">from</span> <span class="st" style="color: #20794D;">"/src/cscheid/cscheid.js"</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-22"></span>
<span id="cb1-23">{</span>
<span id="cb1-24">    <span class="kw" style="color: #003B4F;">var</span> canvasEl <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"#main"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"canvas"</span>)</span>
<span id="cb1-25">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">600</span>)</span>
<span id="cb1-26">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">600</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-27"></span>
<span id="cb1-28">    <span class="kw" style="color: #003B4F;">var</span> canvasCrosshair <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"#main"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"canvas"</span>)</span>
<span id="cb1-29">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">600</span>)</span>
<span id="cb1-30">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">600</span>)</span>
<span id="cb1-31">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">style</span>(<span class="st" style="color: #20794D;">"position"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"relative"</span>)</span>
<span id="cb1-32">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">style</span>(<span class="st" style="color: #20794D;">"top"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"-600px"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-33"></span>
<span id="cb1-34">    d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"#main"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"div"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">style</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"600px"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-35"></span>
<span id="cb1-36">    <span class="kw" style="color: #003B4F;">var</span> ctx <span class="op" style="color: #5E5E5E;">=</span> dom<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">setupCanvas</span>(canvasEl<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">node</span>())<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-37">    <span class="kw" style="color: #003B4F;">var</span> xhCtx <span class="op" style="color: #5E5E5E;">=</span> dom<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">setupCanvas</span>(canvasCrosshair<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">node</span>())<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-38"></span>
<span id="cb1-39">    <span class="co" style="color: #5E5E5E;">// crosshairs</span></span>
<span id="cb1-40">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">fillStyle</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"rgba(0,0,0,0)"</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-41">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">fillRect</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span><span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span><span class="dv" style="color: #AD0000;">600</span><span class="op" style="color: #5E5E5E;">,</span><span class="dv" style="color: #AD0000;">600</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-42">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">strokeStyle</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-43">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">lineWidth</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">1</span> <span class="op" style="color: #5E5E5E;">*</span> ctx<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">dpr</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-44">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">beginPath</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-45">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">moveTo</span>(<span class="dv" style="color: #AD0000;">280</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-46">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">lineTo</span>(<span class="dv" style="color: #AD0000;">320</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-47">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">moveTo</span>(<span class="dv" style="color: #AD0000;">300</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">280</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-48">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">lineTo</span>(<span class="dv" style="color: #AD0000;">300</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">320</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-49">    xhCtx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">stroke</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-50"></span>
<span id="cb1-51">    canvasEl<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">node</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">style</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">filter</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"blur(10px)"</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-52"></span>
<span id="cb1-53">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">tick</span>()</span>
<span id="cb1-54">    {</span>
<span id="cb1-55">    <span class="kw" style="color: #003B4F;">var</span> now <span class="op" style="color: #5E5E5E;">=</span> time<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">elapsed</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-56"></span>
<span id="cb1-57">    <span class="co" style="color: #5E5E5E;">// wipe</span></span>
<span id="cb1-58">    ctx<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">fillStyle</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"white"</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-59">    ctx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">fillRect</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span><span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span><span class="dv" style="color: #AD0000;">600</span><span class="op" style="color: #5E5E5E;">,</span><span class="dv" style="color: #AD0000;">600</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-60"></span>
<span id="cb1-61">    ctx<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">lineWidth</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">30</span> <span class="op" style="color: #5E5E5E;">*</span> ctx<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">dpr</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-62"></span>
<span id="cb1-63">    <span class="kw" style="color: #003B4F;">var</span> nSteps <span class="op" style="color: #5E5E5E;">=</span> <span class="op" style="color: #5E5E5E;">~~</span>(<span class="dv" style="color: #AD0000;">100</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">2</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-64">    <span class="kw" style="color: #003B4F;">var</span> radius <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">200</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-65">    <span class="kw" style="color: #003B4F;">var</span> xScale <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">50</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">550</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-66">    <span class="kw" style="color: #003B4F;">var</span> yScale <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">550</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">50</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-67"></span>
<span id="cb1-68">    <span class="cf" style="color: #003B4F;">for</span> (<span class="kw" style="color: #003B4F;">var</span> i<span class="op" style="color: #5E5E5E;">=</span><span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">;</span> i<span class="op" style="color: #5E5E5E;">&lt;</span>nSteps<span class="op" style="color: #5E5E5E;">;</span> <span class="op" style="color: #5E5E5E;">++</span>i) {</span>
<span id="cb1-69">        <span class="kw" style="color: #003B4F;">var</span> angleBeg <span class="op" style="color: #5E5E5E;">=</span> (i <span class="op" style="color: #5E5E5E;">/</span> nSteps) <span class="op" style="color: #5E5E5E;">*</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-70">        <span class="kw" style="color: #003B4F;">var</span> angleEnd <span class="op" style="color: #5E5E5E;">=</span> ((i<span class="op" style="color: #5E5E5E;">+</span><span class="fl" style="color: #AD0000;">1.5</span>) <span class="op" style="color: #5E5E5E;">/</span> nSteps) <span class="op" style="color: #5E5E5E;">*</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-71">        <span class="kw" style="color: #003B4F;">var</span> lerp <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">interpolateLab</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(angleBeg <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">180</span> <span class="op" style="color: #5E5E5E;">/</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">70</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">50</span>)<span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"white"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-72"></span>
<span id="cb1-73">        <span class="kw" style="color: #003B4F;">var</span> gapCenterAngle <span class="op" style="color: #5E5E5E;">=</span> now <span class="op" style="color: #5E5E5E;">*</span> (<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">2</span>) <span class="op" style="color: #5E5E5E;">%</span> (<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">2</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-74">        <span class="kw" style="color: #003B4F;">var</span> sigma2 <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-75">        <span class="kw" style="color: #003B4F;">var</span> weight <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">max</span>(</span>
<span id="cb1-76">        <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">exp</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">pow</span>(gapCenterAngle <span class="op" style="color: #5E5E5E;">-</span> angleBeg<span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">2</span>) <span class="op" style="color: #5E5E5E;">/</span> sigma2)<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-77">        <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">exp</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">pow</span>((gapCenterAngle <span class="op" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">2</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span>) <span class="op" style="color: #5E5E5E;">-</span> angleBeg<span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">2</span>) <span class="op" style="color: #5E5E5E;">/</span> sigma2)<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-78">        <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">exp</span>(<span class="op" style="color: #5E5E5E;">-</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">pow</span>((gapCenterAngle <span class="op" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">2</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span>) <span class="op" style="color: #5E5E5E;">-</span> angleBeg<span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">2</span>) <span class="op" style="color: #5E5E5E;">/</span> sigma2)<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-79">        )<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-80"></span>
<span id="cb1-81">        ctx<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">strokeStyle</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">String</span>(<span class="fu" style="color: #4758AB;">lerp</span>(weight))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-82">        ctx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">beginPath</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-83">        ctx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">moveTo</span>(<span class="fu" style="color: #4758AB;">xScale</span>(<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(angleBeg))<span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">yScale</span>(<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(angleBeg)))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-84">        ctx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">lineTo</span>(<span class="fu" style="color: #4758AB;">xScale</span>(<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(angleEnd))<span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">yScale</span>(<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(angleEnd)))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-85">        ctx<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">stroke</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-86">    }</span>
<span id="cb1-87"></span>
<span id="cb1-88">    <span class="bu" style="color: null;">window</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">requestAnimationFrame</span>(tick)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-89">    }</span>
<span id="cb1-90"></span>
<span id="cb1-91">    <span class="fu" style="color: #4758AB;">tick</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-92">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>I’m sure this has been discovered before, but I came up with this particular version.</p>


<!-- -->

</section>

 ]]></description>
  <category>optical-illusion</category>
  <guid>https://cscheid.net/v2/hacks/ring-gap.html</guid>
  <pubDate>Thu, 27 Sep 2018 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/images/ring-with-rotating-gap.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Curvature Blindness</title>
  <link>https://cscheid.net/v2/hacks/curvature-blindness.html</link>
  <description><![CDATA[ 



<p>Over a gray background, some of the wiggly lines appear much more triangular in shape than they do over a white or black background.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="11" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 10;"><span id="cb1-11">{</span>
<span id="cb1-12">  <span class="kw" style="color: #003B4F;">const</span> svgEl <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">html</span><span class="vs" style="color: #20794D;">`&lt;svg viewBox="0 0 600 600" width="100%" height="100%"&gt;&lt;/svg&gt;`</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">  <span class="kw" style="color: #003B4F;">const</span> svg <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(svgEl)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-15"></span>
<span id="cb1-16">  <span class="kw" style="color: #003B4F;">const</span> lst <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="dv" style="color: #AD0000;">600</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-17"></span>
<span id="cb1-18">  <span class="kw" style="color: #003B4F;">const</span> xScale <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">600</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">2</span> <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">10</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-19">  <span class="kw" style="color: #003B4F;">const</span> yScale <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">12</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-20"></span>
<span id="cb1-21">  <span class="kw" style="color: #003B4F;">const</span> line <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">line</span>()</span>
<span id="cb1-22">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">x</span>(d <span class="kw" style="color: #003B4F;">=&gt;</span> d)</span>
<span id="cb1-23">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">y</span>(d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">yScale</span>(<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(<span class="fu" style="color: #4758AB;">xScale</span>(d))))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-24"></span>
<span id="cb1-25">  <span class="kw" style="color: #003B4F;">const</span> colors <span class="op" style="color: #5E5E5E;">=</span> [d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">25</span>)<span class="op" style="color: #5E5E5E;">,</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">75</span>)]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-26"></span>
<span id="cb1-27">  <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">addWiggles</span>(sel) {</span>
<span id="cb1-28">    sel<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-29">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="dv" style="color: #AD0000;">12</span>))</span>
<span id="cb1-30">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-31">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-32">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> (d<span class="op" style="color: #5E5E5E;">,</span> i) <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="st" style="color: #20794D;">"translate(0, "</span> <span class="op" style="color: #5E5E5E;">+</span> (<span class="dv" style="color: #AD0000;">10</span> <span class="op" style="color: #5E5E5E;">+</span> d <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">50</span>) <span class="op" style="color: #5E5E5E;">+</span> <span class="st" style="color: #20794D;">")"</span>)</span>
<span id="cb1-33">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"path"</span>)</span>
<span id="cb1-34">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(<span class="kw" style="color: #003B4F;">function</span>(d) {</span>
<span id="cb1-35">        <span class="cf" style="color: #003B4F;">if</span> (d <span class="op" style="color: #5E5E5E;">%</span> <span class="dv" style="color: #AD0000;">2</span> <span class="op" style="color: #5E5E5E;">===</span> <span class="dv" style="color: #AD0000;">0</span>) {</span>
<span id="cb1-36">          <span class="cf" style="color: #003B4F;">return</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="dv" style="color: #AD0000;">20</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">map</span>(d2 <span class="kw" style="color: #003B4F;">=&gt;</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(d2 <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">30</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span>  (d2<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">1</span>)<span class="op" style="color: #5E5E5E;">*</span><span class="dv" style="color: #AD0000;">30</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-37">        } <span class="cf" style="color: #003B4F;">else</span> {</span>
<span id="cb1-38">          <span class="cf" style="color: #003B4F;">return</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(<span class="dv" style="color: #AD0000;">21</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">map</span>(d2 <span class="kw" style="color: #003B4F;">=&gt;</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>(d2 <span class="op" style="color: #5E5E5E;">*</span> <span class="dv" style="color: #AD0000;">30</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">16</span><span class="op" style="color: #5E5E5E;">,</span> (d2<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">1</span>)<span class="op" style="color: #5E5E5E;">*</span><span class="dv" style="color: #AD0000;">30</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">14</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-39">        }</span>
<span id="cb1-40">      })</span>
<span id="cb1-41">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-42">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"path"</span>)</span>
<span id="cb1-43">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> (d<span class="op" style="color: #5E5E5E;">,</span> i) <span class="kw" style="color: #003B4F;">=&gt;</span> colors[i<span class="op" style="color: #5E5E5E;">%</span><span class="dv" style="color: #AD0000;">2</span>])</span>
<span id="cb1-44">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"none"</span>)</span>
<span id="cb1-45">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"2px"</span>)</span>
<span id="cb1-46">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"d"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">line</span>(d))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-47">  }</span>
<span id="cb1-48"></span>
<span id="cb1-49">  <span class="kw" style="color: #003B4F;">const</span> backgroundRhombi <span class="op" style="color: #5E5E5E;">=</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-50"></span>
<span id="cb1-51">  backgroundRhombi<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"path"</span>)</span>
<span id="cb1-52">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">50</span>))</span>
<span id="cb1-53">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"d"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"M 300 0 L 900 0 L 300 600 L -300 600 Z"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-54">  backgroundRhombi<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"path"</span>)</span>
<span id="cb1-55">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-56">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"d"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"M 900 0 L 1500 0 L 900 600 L 300 600 Z"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-57">  backgroundRhombi<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"path"</span>)</span>
<span id="cb1-58">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">50</span>))</span>
<span id="cb1-59">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"d"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"M 1500 0 L 2100 0 L 1500 600 L 900 600 Z"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-60"></span>
<span id="cb1-61">  <span class="fu" style="color: #4758AB;">addWiggles</span>(svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-62">  <span class="fu" style="color: #4758AB;">addWiggles</span>(svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(0, 10)"</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-63"></span>
<span id="cb1-64">  <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">move</span>() {</span>
<span id="cb1-65">    backgroundRhombi<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(300,0)"</span>)</span>
<span id="cb1-66">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-67">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">ease</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">easeLinear</span>)</span>
<span id="cb1-68">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">15000</span>)</span>
<span id="cb1-69">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(-300,0)"</span>)</span>
<span id="cb1-70">      <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>() {</span>
<span id="cb1-71">        d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="kw" style="color: #003B4F;">this</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-72">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">ease</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">easeLinear</span>)</span>
<span id="cb1-73">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">15000</span>)</span>
<span id="cb1-74">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(300,0)"</span>)</span>
<span id="cb1-75">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> move)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-76">      })<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-77">  }</span>
<span id="cb1-78"></span>
<span id="cb1-79">  <span class="fu" style="color: #4758AB;">move</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-80">  <span class="cf" style="color: #003B4F;">return</span> svgEl<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-81">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>
<section id="acknowledgments" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgments">Acknowledgments</h2>
<p>This one appears to be <a href="http://blogs.discovermagazine.com/neuroskeptic/2017/12/08/curvature-blindness-illusion/">quite new</a>, published <a href="https://www.ncbi.nlm.nih.gov/pubmed/29204264">in 2017 by K. Takahashi</a>.</p>


<!-- -->

</section>

 ]]></description>
  <category>optical-illusion</category>
  <guid>https://cscheid.net/v2/hacks/curvature-blindness.html</guid>
  <pubDate>Sun, 10 Dec 2017 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/images/curvature-blindness.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Checkerboard and Crosses</title>
  <link>https://cscheid.net/v2/hacks/checkerboard-and-crosses.html</link>
  <description><![CDATA[ 



<p>The checkerboard stays straight throughout the animation.</p>
<div id="main">

</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="12" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 11;"><span id="cb1-12">{</span>
<span id="cb1-13">    <span class="kw" style="color: #003B4F;">var</span> svg <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"#main"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"svg"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">600</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">800</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-14"></span>
<span id="cb1-15">    svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(0,0)"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-16">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">cycleScroll</span>() {</span>
<span id="cb1-17">        svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1000</span>)</span>
<span id="cb1-18">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(0, 200)"</span>)</span>
<span id="cb1-19">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1000</span>)</span>
<span id="cb1-20">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"translate(0,0)"</span>)</span>
<span id="cb1-21">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> cycleScroll)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-22">    }</span>
<span id="cb1-23">    <span class="fu" style="color: #4758AB;">cycleScroll</span>()<span class="op" style="color: #5E5E5E;">;</span>       </span>
<span id="cb1-24"></span>
<span id="cb1-25">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">roundUp</span>(x) {</span>
<span id="cb1-26">        <span class="cf" style="color: #003B4F;">return</span> <span class="op" style="color: #5E5E5E;">~~</span>(x <span class="op" style="color: #5E5E5E;">+</span> <span class="fl" style="color: #AD0000;">0.5</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-27">    }<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-28"></span>
<span id="cb1-29">    <span class="kw" style="color: #003B4F;">var</span> squaresData <span class="op" style="color: #5E5E5E;">=</span> []<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-30">    <span class="kw" style="color: #003B4F;">var</span> xScale <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span><span class="dv" style="color: #AD0000;">12</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">600</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-31">    <span class="kw" style="color: #003B4F;">var</span> yScale <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span><span class="dv" style="color: #AD0000;">12</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">600</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-32">    <span class="cf" style="color: #003B4F;">for</span> (<span class="kw" style="color: #003B4F;">var</span> i<span class="op" style="color: #5E5E5E;">=</span><span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">;</span> i<span class="op" style="color: #5E5E5E;">&lt;</span><span class="dv" style="color: #AD0000;">12</span><span class="op" style="color: #5E5E5E;">;</span> <span class="op" style="color: #5E5E5E;">++</span>i) {</span>
<span id="cb1-33">        <span class="cf" style="color: #003B4F;">for</span> (<span class="kw" style="color: #003B4F;">var</span> j<span class="op" style="color: #5E5E5E;">=</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">;</span> j<span class="op" style="color: #5E5E5E;">&lt;</span><span class="dv" style="color: #AD0000;">12</span><span class="op" style="color: #5E5E5E;">;</span> <span class="op" style="color: #5E5E5E;">++</span>j) {</span>
<span id="cb1-34">            squaresData<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">push</span>({</span>
<span id="cb1-35">                <span class="dt" style="color: #AD0000;">x</span><span class="op" style="color: #5E5E5E;">:</span> i<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y</span><span class="op" style="color: #5E5E5E;">:</span> j<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-36">                <span class="dt" style="color: #AD0000;">color</span><span class="op" style="color: #5E5E5E;">:</span> (i <span class="op" style="color: #5E5E5E;">^</span> j) <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="dv" style="color: #AD0000;">1</span></span>
<span id="cb1-37">            })<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-38">        }</span>
<span id="cb1-39">    }</span>
<span id="cb1-40">    <span class="kw" style="color: #003B4F;">var</span> crossesData <span class="op" style="color: #5E5E5E;">=</span> []<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-41">    <span class="cf" style="color: #003B4F;">for</span> (i<span class="op" style="color: #5E5E5E;">=</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">;</span> i<span class="op" style="color: #5E5E5E;">&lt;</span><span class="dv" style="color: #AD0000;">12</span><span class="op" style="color: #5E5E5E;">;</span> <span class="op" style="color: #5E5E5E;">++</span>i) {</span>
<span id="cb1-42">        <span class="cf" style="color: #003B4F;">for</span> (j<span class="op" style="color: #5E5E5E;">=</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">;</span> j<span class="op" style="color: #5E5E5E;">&lt;</span><span class="dv" style="color: #AD0000;">11</span><span class="op" style="color: #5E5E5E;">;</span> <span class="op" style="color: #5E5E5E;">++</span>j) {</span>
<span id="cb1-43">            <span class="kw" style="color: #003B4F;">var</span> c <span class="op" style="color: #5E5E5E;">=</span> i <span class="op" style="color: #5E5E5E;">+</span> j<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-44">            <span class="kw" style="color: #003B4F;">var</span> vs <span class="op" style="color: #5E5E5E;">=</span> [<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-45">            <span class="kw" style="color: #003B4F;">var</span> vs2 <span class="op" style="color: #5E5E5E;">=</span> [<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-46">            crossesData<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">push</span>({</span>
<span id="cb1-47">                <span class="dt" style="color: #AD0000;">x</span><span class="op" style="color: #5E5E5E;">:</span> i<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y</span><span class="op" style="color: #5E5E5E;">:</span> j<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-48">                <span class="dt" style="color: #AD0000;">color_1</span><span class="op" style="color: #5E5E5E;">:</span> vs[c <span class="op" style="color: #5E5E5E;">%</span> <span class="dv" style="color: #AD0000;">8</span>]<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-49">                <span class="dt" style="color: #AD0000;">color_2</span><span class="op" style="color: #5E5E5E;">:</span> (i <span class="op" style="color: #5E5E5E;">^</span> j) <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-50">                <span class="dt" style="color: #AD0000;">color_3</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">random</span>() <span class="op" style="color: #5E5E5E;">&gt;</span> <span class="fl" style="color: #AD0000;">0.5</span> <span class="op" style="color: #5E5E5E;">?</span> <span class="dv" style="color: #AD0000;">1</span> <span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-51">                <span class="dt" style="color: #AD0000;">color_4</span><span class="op" style="color: #5E5E5E;">:</span> vs2[c <span class="op" style="color: #5E5E5E;">%</span> <span class="dv" style="color: #AD0000;">4</span>]</span>
<span id="cb1-52">            })<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-53">        }</span>
<span id="cb1-54">    }</span>
<span id="cb1-55"></span>
<span id="cb1-56">    svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-57">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"rect"</span>)</span>
<span id="cb1-58">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(squaresData)</span>
<span id="cb1-59">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-60">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"rect"</span>)</span>
<span id="cb1-61">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="op" style="color: #5E5E5E;">~~</span><span class="fu" style="color: #4758AB;">xScale</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span>))</span>
<span id="cb1-62">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="op" style="color: #5E5E5E;">~~</span><span class="fu" style="color: #4758AB;">yScale</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">y</span>))</span>
<span id="cb1-63">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">roundUp</span>(<span class="fu" style="color: #4758AB;">xScale</span>(<span class="dv" style="color: #AD0000;">1</span>) <span class="op" style="color: #5E5E5E;">-</span> <span class="fu" style="color: #4758AB;">xScale</span>(<span class="dv" style="color: #AD0000;">0</span>)))</span>
<span id="cb1-64">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">roundUp</span>(<span class="fu" style="color: #4758AB;">xScale</span>(<span class="dv" style="color: #AD0000;">1</span>) <span class="op" style="color: #5E5E5E;">-</span> <span class="fu" style="color: #4758AB;">xScale</span>(<span class="dv" style="color: #AD0000;">0</span>)))</span>
<span id="cb1-65">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">color</span> <span class="op" style="color: #5E5E5E;">?</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">40</span>) <span class="op" style="color: #5E5E5E;">:</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">60</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-66"></span>
<span id="cb1-67">    <span class="kw" style="color: #003B4F;">var</span> crossesG <span class="op" style="color: #5E5E5E;">=</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-68">    <span class="kw" style="color: #003B4F;">var</span> crosses <span class="op" style="color: #5E5E5E;">=</span> crossesG</span>
<span id="cb1-69">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"path"</span>)</span>
<span id="cb1-70">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(crossesData)</span>
<span id="cb1-71">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-72">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"path"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-73"></span>
<span id="cb1-74">    <span class="kw" style="color: #003B4F;">var</span> lightCross <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">100</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-75">    <span class="kw" style="color: #003B4F;">var</span> darkCross <span class="op" style="color: #5E5E5E;">=</span>  d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-76"></span>
<span id="cb1-77">    crosses</span>
<span id="cb1-78">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"transform"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> (<span class="st" style="color: #20794D;">"translate("</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;">xScale</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span>) <span class="op" style="color: #5E5E5E;">+</span> <span class="st" style="color: #20794D;">","</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;">yScale</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">y</span>) <span class="op" style="color: #5E5E5E;">+</span> <span class="st" style="color: #20794D;">")"</span>))</span>
<span id="cb1-79">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"d"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"M -2,-2  l 0,-6  l 2,-2  l 2,2  l 0,6  l 6,0  l 2,2  l -2,2  l -6,0  l 0,6  l -2,2 l -2,-2  l 0,-6  l -6,0  l -2,-2 l 2,-2"</span>)</span>
<span id="cb1-80">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="op" style="color: #5E5E5E;">!</span>d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">color_1</span> <span class="op" style="color: #5E5E5E;">?</span> darkCross <span class="op" style="color: #5E5E5E;">:</span> lightCross)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-81"></span>
<span id="cb1-82">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">changeToAndThen</span>(f<span class="op" style="color: #5E5E5E;">,</span> next) {</span>
<span id="cb1-83">        crossesG<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"path"</span>)</span>
<span id="cb1-84">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-85">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">delay</span>(<span class="dv" style="color: #AD0000;">1000</span>)</span>
<span id="cb1-86">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">2000</span>)</span>
<span id="cb1-87">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"opacity"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-88">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-89">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">10</span>)</span>
<span id="cb1-90">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> f)</span>
<span id="cb1-91">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-92">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">2000</span>)</span>
<span id="cb1-93">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"opacity"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>)</span>
<span id="cb1-94">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> (d<span class="op" style="color: #5E5E5E;">,</span> i) <span class="kw" style="color: #003B4F;">=&gt;</span> i <span class="op" style="color: #5E5E5E;">===</span> <span class="dv" style="color: #AD0000;">0</span> <span class="op" style="color: #5E5E5E;">?</span> <span class="fu" style="color: #4758AB;">next</span>() <span class="op" style="color: #5E5E5E;">:</span> <span class="kw" style="color: #003B4F;">null</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-95">    }</span>
<span id="cb1-96"></span>
<span id="cb1-97">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">cyclePatterns</span>() {</span>
<span id="cb1-98">        <span class="kw" style="color: #003B4F;">var</span> accessors <span class="op" style="color: #5E5E5E;">=</span> [<span class="st" style="color: #20794D;">"color_1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"color_2"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"color_3"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"color_4"</span>]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-99">        <span class="kw" style="color: #003B4F;">var</span> fs <span class="op" style="color: #5E5E5E;">=</span> accessors<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">map</span>((accessor<span class="op" style="color: #5E5E5E;">,</span> i) <span class="kw" style="color: #003B4F;">=&gt;</span></span>
<span id="cb1-100">                            (() <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">changeToAndThen</span>(d <span class="kw" style="color: #003B4F;">=&gt;</span> d[accessor] <span class="op" style="color: #5E5E5E;">?</span> darkCross <span class="op" style="color: #5E5E5E;">:</span> lightCross<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-101">                                                    fs[(i<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">1</span>)<span class="op" style="color: #5E5E5E;">%</span>accessors<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">length</span>])))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-102">        fs[<span class="dv" style="color: #AD0000;">0</span>]()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-103">    }</span>
<span id="cb1-104"></span>
<span id="cb1-105">    <span class="fu" style="color: #4758AB;">cyclePatterns</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-106">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>
<section id="acknowledgments" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgments">Acknowledgments</h2>
<p>(<a href="http://bigblueboo.tumblr.com/post/81390584151/fooled-ya-brain">Source</a>). Thanks, <a href="https://twitter.com/Peter_shirley">Pete</a>!.</p>


<!-- -->

</section>

 ]]></description>
  <category>optical-illusion</category>
  <guid>https://cscheid.net/v2/hacks/checkerboard-and-crosses.html</guid>
  <pubDate>Tue, 05 Dec 2017 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/images/checkerboard-and-crosses.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Seven Circles</title>
  <link>https://cscheid.net/v2/hacks/seven-circles.html</link>
  <description><![CDATA[ 



<p>The middle circle stays the same size throughout the animation.</p>
<div id="main">

</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="12" data-source-offset="0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 11;"><span id="cb1-12">{</span>
<span id="cb1-13">    <span class="kw" style="color: #003B4F;">var</span> svg <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(<span class="st" style="color: #20794D;">"#main"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"svg"</span>)</span>
<span id="cb1-14">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"viewBox"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"0 0 600 600"</span>)</span>
<span id="cb1-15">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"100%"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"height"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"100%"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-16">    <span class="kw" style="color: #003B4F;">var</span> center <span class="op" style="color: #5E5E5E;">=</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-17">    center<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">48</span>) <span class="co" style="color: #5E5E5E;">// 2-pixel margin</span></span>
<span id="cb1-18">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)</span>
<span id="cb1-19">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)</span>
<span id="cb1-20">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">lab</span>(<span class="dv" style="color: #AD0000;">50</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">60</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-21"></span>
<span id="cb1-22">    <span class="kw" style="color: #003B4F;">var</span> circleData <span class="op" style="color: #5E5E5E;">=</span> [{</span>
<span id="cb1-23">        <span class="dt" style="color: #AD0000;">dx</span><span class="op" style="color: #5E5E5E;">:</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-24">        <span class="dt" style="color: #AD0000;">dy</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span></span>
<span id="cb1-25">    }<span class="op" style="color: #5E5E5E;">,</span> {</span>
<span id="cb1-26">        <span class="dt" style="color: #AD0000;">dx</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-27">        <span class="dt" style="color: #AD0000;">dy</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span></span>
<span id="cb1-28">    }<span class="op" style="color: #5E5E5E;">,</span> {</span>
<span id="cb1-29">        <span class="dt" style="color: #AD0000;">dx</span><span class="op" style="color: #5E5E5E;">:</span> <span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">0.5</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-30">        <span class="dt" style="color: #AD0000;">dy</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sqrt</span>(<span class="dv" style="color: #AD0000;">3</span>)<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb1-31">    }<span class="op" style="color: #5E5E5E;">,</span> {</span>
<span id="cb1-32">        <span class="dt" style="color: #AD0000;">dx</span><span class="op" style="color: #5E5E5E;">:</span> <span class="fl" style="color: #AD0000;">0.5</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-33">        <span class="dt" style="color: #AD0000;">dy</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sqrt</span>(<span class="dv" style="color: #AD0000;">3</span>)<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb1-34">    }<span class="op" style="color: #5E5E5E;">,</span> {</span>
<span id="cb1-35">        <span class="dt" style="color: #AD0000;">dx</span><span class="op" style="color: #5E5E5E;">:</span> <span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">0.5</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-36">        <span class="dt" style="color: #AD0000;">dy</span><span class="op" style="color: #5E5E5E;">:</span> <span class="op" style="color: #5E5E5E;">-</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sqrt</span>(<span class="dv" style="color: #AD0000;">3</span>)<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb1-37">    }<span class="op" style="color: #5E5E5E;">,</span> {</span>
<span id="cb1-38">        <span class="dt" style="color: #AD0000;">dx</span><span class="op" style="color: #5E5E5E;">:</span> <span class="fl" style="color: #AD0000;">0.5</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-39">        <span class="dt" style="color: #AD0000;">dy</span><span class="op" style="color: #5E5E5E;">:</span> <span class="op" style="color: #5E5E5E;">-</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sqrt</span>(<span class="dv" style="color: #AD0000;">3</span>)<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span></span>
<span id="cb1-40">    }]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-41"></span>
<span id="cb1-42">    <span class="kw" style="color: #003B4F;">var</span> circles <span class="op" style="color: #5E5E5E;">=</span> svg<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)</span>
<span id="cb1-43">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-44">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(circleData)</span>
<span id="cb1-45">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-46">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-47"></span>
<span id="cb1-48">    <span class="kw" style="color: #003B4F;">var</span> xScaleSmall <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">200</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">400</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-49">    <span class="kw" style="color: #003B4F;">var</span> yScaleSmall <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">400</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">200</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-50">    <span class="kw" style="color: #003B4F;">var</span> xScaleBig <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">120</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">420</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-51">    <span class="kw" style="color: #003B4F;">var</span> yScaleBig <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">1</span>])<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">range</span>([<span class="dv" style="color: #AD0000;">420</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">120</span>])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-52"></span>
<span id="cb1-53">    circles<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">xScaleSmall</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">dx</span>))</span>
<span id="cb1-54">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">yScaleSmall</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">dy</span>))</span>
<span id="cb1-55">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">48</span>)</span>
<span id="cb1-56">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">lab</span>(<span class="dv" style="color: #AD0000;">50</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">60</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-57"></span>
<span id="cb1-58">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">cycleBig</span>() {</span>
<span id="cb1-59">        center<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-60">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1000</span>)</span>
<span id="cb1-61">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">270</span>)</span>
<span id="cb1-62">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">270</span>)</span>
<span id="cb1-63">        <span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-64">        </span>
<span id="cb1-65">        circles<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-66">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1000</span>)</span>
<span id="cb1-67">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">xScaleBig</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">dx</span>))</span>
<span id="cb1-68">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">yScaleBig</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">dy</span>))</span>
<span id="cb1-69">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">68</span>)</span>
<span id="cb1-70">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">lab</span>(<span class="dv" style="color: #AD0000;">50</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">60</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-71">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> cycleSmall)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-72">    }</span>
<span id="cb1-73"></span>
<span id="cb1-74">    <span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">cycleSmall</span>() {</span>
<span id="cb1-75">        center<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-76">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1000</span>)</span>
<span id="cb1-77">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)</span>
<span id="cb1-78">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">300</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-79"></span>
<span id="cb1-80">        circles<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">transition</span>()</span>
<span id="cb1-81">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">duration</span>(<span class="dv" style="color: #AD0000;">1000</span>)</span>
<span id="cb1-82">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">xScaleSmall</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">dx</span>))</span>
<span id="cb1-83">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="fu" style="color: #4758AB;">yScaleSmall</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">dy</span>))</span>
<span id="cb1-84">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">48</span>)</span>
<span id="cb1-85">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">lab</span>(<span class="dv" style="color: #AD0000;">50</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">60</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>))</span>
<span id="cb1-86">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> cycleBig)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-87">    }</span>
<span id="cb1-88"></span>
<span id="cb1-89">    <span class="fu" style="color: #4758AB;">cycleBig</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-90"></span>
<span id="cb1-91">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>


<!-- -->


 ]]></description>
  <category>optical-illusion</category>
  <guid>https://cscheid.net/v2/hacks/seven-circles.html</guid>
  <pubDate>Wed, 29 Nov 2017 00:00:00 GMT</pubDate>
  <media:content url="https://cscheid.net/v2/images/seven-circles.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Trigonometry</title>
  <link>https://cscheid.net/v2/explainers/trigonometry.html</link>
  <description><![CDATA[ 



<section id="the-basics" class="level2">
<h2 class="anchored" data-anchor-id="the-basics">The basics</h2>
<p><a href="https://twitter.com/divbyzero/status/927517766369804289">Just like everyone else on twitter</a>, when I saw this diagram below my reaction was: “why didn’t they show this to me 25 years ago?” The lengths of the triangle legs correspond to the values of the trigonometric functions. Drag the point to change the diagram around.</p>
<div class="cell">
<details class="hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="12" data-source-offset="-0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 11;"><span id="cb1-12"><span class="im" style="color: #00769E;">import</span> { plot } <span class="im" style="color: #00769E;">from</span> <span class="st" style="color: #20794D;">"/src/cscheid/cscheid.js"</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-13">{</span>
<span id="cb1-14">  <span class="bu" style="color: null;">window</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">d3</span> <span class="op" style="color: #5E5E5E;">=</span> d3<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-15">  <span class="bu" style="color: null;">window</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">_</span> <span class="op" style="color: #5E5E5E;">=</span> _<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-16">  <span class="kw" style="color: #003B4F;">const</span> main <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;">svg</span><span class="vs" style="color: #20794D;">`&lt;svg viewbox="0 0 600 300" width="100%" height="100%"&gt;&lt;/svg&gt;`</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="kw" style="color: #003B4F;">var</span> s <span class="op" style="color: #5E5E5E;">=</span> plot<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">surface</span>({</span>
<span id="cb1-19">    <span class="dt" style="color: #AD0000;">element</span><span class="op" style="color: #5E5E5E;">:</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">select</span>(main)<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-20">    <span class="dt" style="color: #AD0000;">width</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">600</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-21">    <span class="dt" style="color: #AD0000;">height</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">300</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-22">    <span class="dt" style="color: #AD0000;">margin</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-23">    <span class="dt" style="color: #AD0000;">xScale</span><span class="op" style="color: #5E5E5E;">:</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">3</span>])<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-24">    <span class="dt" style="color: #AD0000;">yScale</span><span class="op" style="color: #5E5E5E;">:</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">scaleLinear</span>()<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">domain</span>([<span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fl" style="color: #AD0000;">1.5</span>])<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-25">    <span class="dt" style="color: #AD0000;">axes</span><span class="op" style="color: #5E5E5E;">:</span> <span class="kw" style="color: #003B4F;">false</span></span>
<span id="cb1-26">})<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="kw" style="color: #003B4F;">var</span> xScale <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">xScale</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">appendDefault</span>(el) {</span>
<span id="cb1-31">    <span class="cf" style="color: #003B4F;">return</span> <span class="kw" style="color: #003B4F;">function</span>(sel) {</span>
<span id="cb1-32">        <span class="cf" style="color: #003B4F;">return</span> sel<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-33">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(el)</span>
<span id="cb1-34">            <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">each</span>(<span class="kw" style="color: #003B4F;">function</span>(d) {</span>
<span id="cb1-35">                <span class="kw" style="color: #003B4F;">var</span> innerSel <span class="op" style="color: #5E5E5E;">=</span> sel<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">_select</span>(<span class="kw" style="color: #003B4F;">this</span>)<span class="op" style="color: #5E5E5E;">;</span> <span class="co" style="color: #5E5E5E;">// hack to use inner selection context</span></span>
<span id="cb1-36">                <span class="cf" style="color: #003B4F;">for</span> (<span class="kw" style="color: #003B4F;">var</span> key <span class="kw" style="color: #003B4F;">in</span> d) {</span>
<span id="cb1-37">                    innerSel<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(key<span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d[key])<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-38">                }</span>
<span id="cb1-39">            })<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-40">    }<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-41">}</span>
<span id="cb1-42"></span>
<span id="cb1-43">s<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)</span>
<span id="cb1-44">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="fu" style="color: #4758AB;">xScale</span>(<span class="dv" style="color: #AD0000;">1</span>) <span class="op" style="color: #5E5E5E;">-</span> <span class="fu" style="color: #4758AB;">xScale</span>(<span class="dv" style="color: #AD0000;">0</span>))  <span class="co" style="color: #5E5E5E;">// annoying...</span></span>
<span id="cb1-45">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-46">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-47">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb1-48">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"none"</span>)</span>
<span id="cb1-49">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"3px"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-50"></span>
<span id="cb1-51">s<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-52">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>)</span>
<span id="cb1-53">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span>  <span class="dv" style="color: #AD0000;">1</span>)</span>
<span id="cb1-54">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y1"</span><span class="op" style="color: #5E5E5E;">,</span>  <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-55">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y2"</span><span class="op" style="color: #5E5E5E;">,</span>  <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-56">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb1-57">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"none"</span>)</span>
<span id="cb1-58">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"1px"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-59"></span>
<span id="cb1-60">s<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-61">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y1"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="op" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>)</span>
<span id="cb1-62">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y2"</span><span class="op" style="color: #5E5E5E;">,</span>  <span class="dv" style="color: #AD0000;">1</span>)</span>
<span id="cb1-63">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x1"</span><span class="op" style="color: #5E5E5E;">,</span>  <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-64">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x2"</span><span class="op" style="color: #5E5E5E;">,</span>  <span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-65">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb1-66">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"none"</span>)</span>
<span id="cb1-67">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"1px"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-68"></span>
<span id="cb1-69"><span class="kw" style="color: #003B4F;">var</span> t <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="cn" style="color: #8f5902;">PI</span><span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-70"></span>
<span id="cb1-71"><span class="kw" style="color: #003B4F;">var</span> linesG <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-72"><span class="kw" style="color: #003B4F;">var</span> arcG <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-73"></span>
<span id="cb1-74"><span class="kw" style="color: #003B4F;">var</span> h0 <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">30</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-75"><span class="kw" style="color: #003B4F;">var</span> c0 <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">70</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-76"><span class="kw" style="color: #003B4F;">var</span> l0 <span class="op" style="color: #5E5E5E;">=</span> <span class="dv" style="color: #AD0000;">50</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-77"><span class="kw" style="color: #003B4F;">var</span> colors <span class="op" style="color: #5E5E5E;">=</span> [</span>
<span id="cb1-78">d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(h0<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>   <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">0</span>)    <span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-79">d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(h0<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>   c0<span class="op" style="color: #5E5E5E;">,</span> l0)  <span class="op" style="color: #5E5E5E;">,</span>    </span>
<span id="cb1-80">d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(h0<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">180</span><span class="op" style="color: #5E5E5E;">,</span> c0<span class="op" style="color: #5E5E5E;">,</span> l0)  <span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-81">d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(h0<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">60</span><span class="op" style="color: #5E5E5E;">,</span>  c0<span class="op" style="color: #5E5E5E;">,</span> l0)  <span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-82">d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(h0<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">240</span><span class="op" style="color: #5E5E5E;">,</span> c0<span class="op" style="color: #5E5E5E;">,</span> l0)  <span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-83">d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(h0<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">120</span><span class="op" style="color: #5E5E5E;">,</span> c0<span class="op" style="color: #5E5E5E;">,</span> l0)  <span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-84">d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(h0<span class="op" style="color: #5E5E5E;">+</span><span class="dv" style="color: #AD0000;">300</span><span class="op" style="color: #5E5E5E;">,</span> c0<span class="op" style="color: #5E5E5E;">,</span> l0)  <span class="op" style="color: #5E5E5E;">,</span>    </span>
<span id="cb1-85">]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-86"></span>
<span id="cb1-87"><span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">updateLines</span>() {</span>
<span id="cb1-88">    linesG<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"line"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">remove</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-89">    <span class="kw" style="color: #003B4F;">var</span> lines <span class="op" style="color: #5E5E5E;">=</span> [</span>
<span id="cb1-90">        { <span class="dt" style="color: #AD0000;">x1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">x2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>                         <span class="dt" style="color: #AD0000;">stroke</span><span class="op" style="color: #5E5E5E;">:</span>  colors[<span class="dv" style="color: #AD0000;">0</span>]<span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">1</span> }<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-91">        </span>
<span id="cb1-92">        { <span class="dt" style="color: #AD0000;">x1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">x2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">/</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>             <span class="dt" style="color: #AD0000;">stroke</span><span class="op" style="color: #5E5E5E;">:</span>  colors[<span class="dv" style="color: #AD0000;">1</span>]<span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"5px"</span> }<span class="op" style="color: #5E5E5E;">,</span>   </span>
<span id="cb1-93">        { <span class="dt" style="color: #AD0000;">x1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">x2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>             <span class="dt" style="color: #AD0000;">y2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">/</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">stroke</span><span class="op" style="color: #5E5E5E;">:</span>  colors[<span class="dv" style="color: #AD0000;">2</span>]<span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"5px"</span> }<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-94">        </span>
<span id="cb1-95">        { <span class="dt" style="color: #AD0000;">x1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">x2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>             <span class="dt" style="color: #AD0000;">y2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span>   <span class="dt" style="color: #AD0000;">stroke</span><span class="op" style="color: #5E5E5E;">:</span>  colors[<span class="dv" style="color: #AD0000;">3</span>]<span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"5px"</span> }<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-96">        { <span class="dt" style="color: #AD0000;">x1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>           <span class="dt" style="color: #AD0000;">x2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span>   <span class="dt" style="color: #AD0000;">y2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span>   <span class="dt" style="color: #AD0000;">stroke</span><span class="op" style="color: #5E5E5E;">:</span>  colors[<span class="dv" style="color: #AD0000;">4</span>]<span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"5px"</span> }<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-97"></span>
<span id="cb1-98">        { <span class="dt" style="color: #AD0000;">x1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>                     <span class="dt" style="color: #AD0000;">x2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">/</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>             <span class="dt" style="color: #AD0000;">stroke</span><span class="op" style="color: #5E5E5E;">:</span>  colors[<span class="dv" style="color: #AD0000;">5</span>]<span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"5px"</span> }<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-99">        { <span class="dt" style="color: #AD0000;">x1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y1</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>                     <span class="dt" style="color: #AD0000;">x2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">,</span>             <span class="dt" style="color: #AD0000;">y2</span><span class="op" style="color: #5E5E5E;">:</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">/</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">stroke</span><span class="op" style="color: #5E5E5E;">:</span>  colors[<span class="dv" style="color: #AD0000;">6</span>]<span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"5px"</span> }<span class="op" style="color: #5E5E5E;">,</span></span>
<span id="cb1-100">    ]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-101">    </span>
<span id="cb1-102">    linesG<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"line"</span>)</span>
<span id="cb1-103">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(lines)</span>
<span id="cb1-104">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">callReturn</span>(<span class="fu" style="color: #4758AB;">appendDefault</span>(<span class="st" style="color: #20794D;">"line"</span>))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-105"></span>
<span id="cb1-106">    arcG<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"path"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">remove</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-107"></span>
<span id="cb1-108">    <span class="kw" style="color: #003B4F;">var</span> r <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">xScale</span>(<span class="fl" style="color: #AD0000;">0.1</span>) <span class="op" style="color: #5E5E5E;">-</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">xScale</span>(<span class="dv" style="color: #AD0000;">0</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-109">    <span class="co" style="color: #5E5E5E;">// awkward again..</span></span>
<span id="cb1-110">    arcG<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"path"</span>)</span>
<span id="cb1-111">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"d"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"M "</span></span>
<span id="cb1-112">              <span class="op" style="color: #5E5E5E;">+</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">xScale</span>(<span class="fl" style="color: #AD0000;">0.1</span>) <span class="op" style="color: #5E5E5E;">+</span> <span class="st" style="color: #20794D;">" "</span> <span class="op" style="color: #5E5E5E;">+</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">yScale</span>(<span class="dv" style="color: #AD0000;">0</span>)</span>
<span id="cb1-113">              <span class="op" style="color: #5E5E5E;">+</span> <span class="st" style="color: #20794D;">" A "</span> <span class="op" style="color: #5E5E5E;">+</span> r <span class="op" style="color: #5E5E5E;">+</span> <span class="st" style="color: #20794D;">" "</span> <span class="op" style="color: #5E5E5E;">+</span> r <span class="op" style="color: #5E5E5E;">+</span> <span class="st" style="color: #20794D;">" 0 0 0 "</span></span>
<span id="cb1-114">              <span class="op" style="color: #5E5E5E;">+</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">xScale</span>(<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">0.1</span>) <span class="op" style="color: #5E5E5E;">+</span> <span class="st" style="color: #20794D;">" "</span> <span class="op" style="color: #5E5E5E;">+</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">yScale</span>(<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">0.1</span>))</span>
<span id="cb1-115">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb1-116">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"none"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-117">}</span>
<span id="cb1-118"><span class="fu" style="color: #4758AB;">updateLines</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-119"></span>
<span id="cb1-120"><span class="kw" style="color: #003B4F;">var</span> annotationsG <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-121"><span class="kw" style="color: #003B4F;">function</span> <span class="fu" style="color: #4758AB;">updateAnnotations</span>() {</span>
<span id="cb1-122">    annotationsG<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">remove</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-123"></span>
<span id="cb1-124">    <span class="kw" style="color: #003B4F;">var</span> tx <span class="op" style="color: #5E5E5E;">=</span> (<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t) <span class="op" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">/</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t))<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> ty <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-125">    <span class="kw" style="color: #003B4F;">var</span> ctx <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> cty <span class="op" style="color: #5E5E5E;">=</span> (<span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t) <span class="op" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">/</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t))<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-126"></span>
<span id="cb1-127">    <span class="kw" style="color: #003B4F;">var</span> annotations <span class="op" style="color: #5E5E5E;">=</span> [</span>
<span id="cb1-128">        { <span class="dt" style="color: #AD0000;">x</span><span class="op" style="color: #5E5E5E;">:</span> tx <span class="op" style="color: #5E5E5E;">-</span> ty <span class="op" style="color: #5E5E5E;">/</span> <span class="dv" style="color: #AD0000;">20</span><span class="op" style="color: #5E5E5E;">,</span>   <span class="dt" style="color: #AD0000;">y</span><span class="op" style="color: #5E5E5E;">:</span> ty <span class="op" style="color: #5E5E5E;">+</span> tx <span class="op" style="color: #5E5E5E;">/</span> <span class="dv" style="color: #AD0000;">20</span><span class="op" style="color: #5E5E5E;">,</span>   <span class="dt" style="color: #AD0000;">text</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"tangent"</span><span class="op" style="color: #5E5E5E;">,</span>   <span class="dt" style="color: #AD0000;">fill</span><span class="op" style="color: #5E5E5E;">:</span> colors[<span class="dv" style="color: #AD0000;">1</span>] }<span class="op" style="color: #5E5E5E;">,</span> <span class="co" style="color: #5E5E5E;">// { x1: Math.cos(t), y1: Math.sin(t), x2: 1/Math.cos(t), y2: 0,             stroke: d3.hcl(0, 60, 60)    },   </span></span>
<span id="cb1-129">        { <span class="dt" style="color: #AD0000;">x</span><span class="op" style="color: #5E5E5E;">:</span> ctx <span class="op" style="color: #5E5E5E;">-</span> cty <span class="op" style="color: #5E5E5E;">/</span> <span class="dv" style="color: #AD0000;">20</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y</span><span class="op" style="color: #5E5E5E;">:</span> cty <span class="op" style="color: #5E5E5E;">+</span> ctx <span class="op" style="color: #5E5E5E;">/</span> <span class="dv" style="color: #AD0000;">20</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">text</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"cotangent"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">fill</span><span class="op" style="color: #5E5E5E;">:</span> colors[<span class="dv" style="color: #AD0000;">2</span>] }<span class="op" style="color: #5E5E5E;">,</span> <span class="co" style="color: #5E5E5E;">// { x1: Math.cos(t), y1: Math.sin(t), x2: 0,             y2: 1/Math.sin(t), stroke: d3.hcl(180, 60, 60)  },</span></span>
<span id="cb1-130">        </span>
<span id="cb1-131">        { <span class="dt" style="color: #AD0000;">x</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">text</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"cosine"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">anchor</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"middle"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">baseline</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"text-before-edge"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">fill</span><span class="op" style="color: #5E5E5E;">:</span> colors[<span class="dv" style="color: #AD0000;">3</span>] }<span class="op" style="color: #5E5E5E;">,</span> <span class="co" style="color: #5E5E5E;">// { x1: Math.cos(t), y1: Math.sin(t), x2: 0,             y2: Math.sin(t),   stroke: d3.hcl(60,  60, 60)  },</span></span>
<span id="cb1-132">        { <span class="dt" style="color: #AD0000;">x</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">text</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"sine"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">anchor</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"right"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">baseline</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"middle"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">fill</span><span class="op" style="color: #5E5E5E;">:</span> colors[<span class="dv" style="color: #AD0000;">4</span>] }<span class="op" style="color: #5E5E5E;">,</span> <span class="co" style="color: #5E5E5E;">// { x1: Math.cos(t), y1: 0,           x2: Math.cos(t),   y2: Math.sin(t),   stroke: d3.hcl(240, 60, 60)  },</span></span>
<span id="cb1-133"></span>
<span id="cb1-134">        { <span class="dt" style="color: #AD0000;">x</span><span class="op" style="color: #5E5E5E;">:</span> <span class="fl" style="color: #AD0000;">0.5</span><span class="op" style="color: #5E5E5E;">/</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y</span><span class="op" style="color: #5E5E5E;">:</span> <span class="fl" style="color: #AD0000;">0.02</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">text</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"secant"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">anchor</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"middle"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">fill</span><span class="op" style="color: #5E5E5E;">:</span> colors[<span class="dv" style="color: #AD0000;">5</span>] }<span class="op" style="color: #5E5E5E;">,</span> <span class="co" style="color: #5E5E5E;">// { x1: 0, y1: 0,                     x2: 1/Math.cos(t), y2: 0,             stroke: d3.hcl(120, 60, 60)  },</span></span>
<span id="cb1-135">        { <span class="dt" style="color: #AD0000;">x</span><span class="op" style="color: #5E5E5E;">:</span> <span class="fl" style="color: #AD0000;">0.02</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y</span><span class="op" style="color: #5E5E5E;">:</span> <span class="fl" style="color: #AD0000;">0.5</span><span class="op" style="color: #5E5E5E;">/</span><span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t)<span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">text</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"cosecant"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">baseline</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"middle"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">fill</span><span class="op" style="color: #5E5E5E;">:</span> colors[<span class="dv" style="color: #AD0000;">6</span>] }<span class="op" style="color: #5E5E5E;">,</span> <span class="co" style="color: #5E5E5E;">// { x1: 0, y1: 0,                     x2: 0,             y2: 1/Math.sin(t), stroke: d3.hcl(300, 60, 60)  }</span></span>
<span id="cb1-136">        { <span class="dt" style="color: #AD0000;">x</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span>)<span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">0.12</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">y</span><span class="op" style="color: #5E5E5E;">:</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t<span class="op" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">2</span>)<span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">0.12</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">text</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"t"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dt" style="color: #AD0000;">fill</span><span class="op" style="color: #5E5E5E;">:</span> <span class="st" style="color: #20794D;">"black"</span> }</span>
<span id="cb1-137">    ]<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-138"></span>
<span id="cb1-139">    annotationsG<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"text"</span>)</span>
<span id="cb1-140">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(annotations)</span>
<span id="cb1-141">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-142">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"text"</span>)</span>
<span id="cb1-143">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span>)</span>
<span id="cb1-144">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">y</span>)</span>
<span id="cb1-145">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">text</span>(d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">text</span>)</span>
<span id="cb1-146">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"white"</span>)</span>
<span id="cb1-147">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"5px"</span>)</span>
<span id="cb1-148">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> <span class="st" style="color: #20794D;">"white"</span>)</span>
<span id="cb1-149">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"text-anchor"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">anchor</span> <span class="op" style="color: #5E5E5E;">||</span> <span class="kw" style="color: #003B4F;">null</span>)</span>
<span id="cb1-150">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"dominant-baseline"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">baseline</span> <span class="op" style="color: #5E5E5E;">||</span> <span class="kw" style="color: #003B4F;">null</span>)</span>
<span id="cb1-151">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"font"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"11pt Helvetica Neue"</span>)</span>
<span id="cb1-152">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"font-weight"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"300"</span>)</span>
<span id="cb1-153">    <span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-154"></span>
<span id="cb1-155">    annotationsG<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"g"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">selectAll</span>(<span class="st" style="color: #20794D;">"text"</span>)</span>
<span id="cb1-156">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">data</span>(annotations)</span>
<span id="cb1-157">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">enter</span>()</span>
<span id="cb1-158">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"text"</span>)</span>
<span id="cb1-159">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"x"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span>)</span>
<span id="cb1-160">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"y"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">y</span>)</span>
<span id="cb1-161">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">text</span>(d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">text</span>)</span>
<span id="cb1-162">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">hcl</span>(d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">fill</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">darker</span>())</span>
<span id="cb1-163">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"text-anchor"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">anchor</span> <span class="op" style="color: #5E5E5E;">||</span> <span class="kw" style="color: #003B4F;">null</span>)</span>
<span id="cb1-164">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"dominant-baseline"</span><span class="op" style="color: #5E5E5E;">,</span> d <span class="kw" style="color: #003B4F;">=&gt;</span> d<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">baseline</span> <span class="op" style="color: #5E5E5E;">||</span> <span class="kw" style="color: #003B4F;">null</span>)</span>
<span id="cb1-165">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"font"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"11pt Helvetica Neue"</span>)</span>
<span id="cb1-166">        <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"font-weight"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"300"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-167"></span>
<span id="cb1-168">}</span>
<span id="cb1-169"><span class="fu" style="color: #4758AB;">updateAnnotations</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-170"></span>
<span id="cb1-171"><span class="kw" style="color: #003B4F;">var</span> circleHandle <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">append</span>(<span class="st" style="color: #20794D;">"circle"</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-172">circleHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">cos</span>(t))</span>
<span id="cb1-173">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sin</span>(t))</span>
<span id="cb1-174">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"r"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="dv" style="color: #AD0000;">8</span>)</span>
<span id="cb1-175">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"fill"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"white"</span>)</span>
<span id="cb1-176">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb1-177">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"stroke-width"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"2px"</span>)</span>
<span id="cb1-178">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cursor"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="st" style="color: #20794D;">"pointer"</span>)</span>
<span id="cb1-179">    <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">call</span>(d3<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">drag</span>()</span>
<span id="cb1-180">          <span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"drag"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>(e) {</span>
<span id="cb1-181">              <span class="kw" style="color: #003B4F;">var</span> x <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">xScale</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">invert</span>(e<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-182">              <span class="kw" style="color: #003B4F;">var</span> y <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">yScale</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">invert</span>(e<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">y</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-183">              <span class="cf" style="color: #003B4F;">if</span> (x <span class="op" style="color: #5E5E5E;">&lt;</span> <span class="fl" style="color: #AD0000;">0.001</span>) x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.001</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-184">              <span class="cf" style="color: #003B4F;">if</span> (y <span class="op" style="color: #5E5E5E;">&lt;</span> <span class="fl" style="color: #AD0000;">0.001</span>) y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.001</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-185">              <span class="cf" style="color: #003B4F;">if</span> (x <span class="op" style="color: #5E5E5E;">&gt;</span> <span class="fl" style="color: #AD0000;">0.999</span>) x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.999</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-186">              <span class="cf" style="color: #003B4F;">if</span> (y <span class="op" style="color: #5E5E5E;">&gt;</span> <span class="fl" style="color: #AD0000;">0.999</span>) y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.999</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-187">              <span class="kw" style="color: #003B4F;">var</span> l <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sqrt</span>(x <span class="op" style="color: #5E5E5E;">*</span> x <span class="op" style="color: #5E5E5E;">+</span> y <span class="op" style="color: #5E5E5E;">*</span> y)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-188">              x <span class="op" style="color: #5E5E5E;">/=</span> l<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-189">              y <span class="op" style="color: #5E5E5E;">/=</span> l<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-190">              t <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">acos</span>(x)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-191">              circleHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> x)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-192">              circleHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> y)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-193">              <span class="fu" style="color: #4758AB;">updateLines</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-194">              <span class="fu" style="color: #4758AB;">updateAnnotations</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-195">          })<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">on</span>(<span class="st" style="color: #20794D;">"end"</span><span class="op" style="color: #5E5E5E;">,</span> <span class="kw" style="color: #003B4F;">function</span>(e) {</span>
<span id="cb1-196">              <span class="kw" style="color: #003B4F;">var</span> x <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">xScale</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">invert</span>(e<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">x</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-197">              <span class="kw" style="color: #003B4F;">var</span> y <span class="op" style="color: #5E5E5E;">=</span> s<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">surface</span><span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">yScale</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">invert</span>(e<span class="op" style="color: #5E5E5E;">.</span><span class="at" style="color: #657422;">y</span>)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-198">              <span class="cf" style="color: #003B4F;">if</span> (x <span class="op" style="color: #5E5E5E;">&lt;</span> <span class="fl" style="color: #AD0000;">0.001</span>) x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.001</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-199">              <span class="cf" style="color: #003B4F;">if</span> (y <span class="op" style="color: #5E5E5E;">&lt;</span> <span class="fl" style="color: #AD0000;">0.001</span>) y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.001</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-200">              <span class="cf" style="color: #003B4F;">if</span> (x <span class="op" style="color: #5E5E5E;">&gt;</span> <span class="fl" style="color: #AD0000;">0.999</span>) x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.999</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-201">              <span class="cf" style="color: #003B4F;">if</span> (y <span class="op" style="color: #5E5E5E;">&gt;</span> <span class="fl" style="color: #AD0000;">0.999</span>) y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.999</span><span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-202">              <span class="kw" style="color: #003B4F;">var</span> l <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">sqrt</span>(x <span class="op" style="color: #5E5E5E;">*</span> x <span class="op" style="color: #5E5E5E;">+</span> y <span class="op" style="color: #5E5E5E;">*</span> y)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-203">              x <span class="op" style="color: #5E5E5E;">/=</span> l<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-204">              y <span class="op" style="color: #5E5E5E;">/=</span> l<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-205">              t <span class="op" style="color: #5E5E5E;">=</span> <span class="bu" style="color: null;">Math</span><span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">acos</span>(x)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-206">              circleHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cx"</span><span class="op" style="color: #5E5E5E;">,</span> x)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-207">              circleHandle<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">attr</span>(<span class="st" style="color: #20794D;">"cy"</span><span class="op" style="color: #5E5E5E;">,</span> y)<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-208">              <span class="fu" style="color: #4758AB;">updateLines</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-209">              <span class="fu" style="color: #4758AB;">updateAnnotations</span>()<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-210">          }))<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-211"></span>
<span id="cb1-212"></span>
<span id="cb1-213">  <span class="cf" style="color: #003B4F;">return</span> main<span class="op" style="color: #5E5E5E;">;</span></span>
<span id="cb1-214">}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
</section>
<section id="complex-exponentials-ftw" class="level2">
<h2 class="anchored" data-anchor-id="complex-exponentials-ftw">Complex Exponentials FTW</h2>
<p>We start from the formula for complex exponentials:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Beqnarray*%7De%5E%7Bix%7D%20&amp;%20&amp;%20=%20&amp;%20%5C%20%5Ccos%20x%20+%20i%20%5Csin%20x%20%5C%5C%20e%5E%7B-ix%7D%20&amp;%20=%20%5C%20%5Ccos%20-x%20+%20i%20%5Csin%20-x%20&amp;%20=%20&amp;%20%5Ccos%20x%20-%20i%20%5Csin%20x%20%5Cend%7Beqnarray*%7D"></p>
<p>We re-arrange this a bit to find a formula for cosines and sines in terms of the exponentials. This is maybe the two trigonometry formulas worth memorizing:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Beqnarray*%7D%20%5Ccos%20x%20&amp;%20=%20&amp;%20%5Cfrac%7Be%5E%7Bix%7D+e%5E%7B-ix%7D%7D%7B2%7D%20%5C%5C%20%5Csin%20x%20&amp;%20=%20&amp;%20%5Cfrac%7Be%5E%7Bix%7D-e%5E%7B-ix%7D%7D%7B2%7D%20%5Cend%7Beqnarray*%7D"></p>
<p>Never memorize a formula for sines and cosines of sums again. <a href="https://wstein.org/edu/winter06/20b/notes/html/node30.html">Stein</a> has some examples of how you can use this.</p>


<!-- -->

</section>

 ]]></description>
  <guid>https://cscheid.net/v2/explainers/trigonometry.html</guid>
  <pubDate>Mon, 06 Nov 2017 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
